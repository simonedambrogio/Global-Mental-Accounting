df$Game2_2_2[df$Game2_2_2=="٠٠"] <- "0"
df$Game2_2_2[df$Game2_2_2=="١"] <- "1"
df$Game2_2_2[df$Game2_2_2=="٢"] <- "2"
df$Game2_2_2[df$Game2_2_2=="١٠"] <- "10"
df$Game2_2_2[df$Game2_2_2=="١٥"] <- "15"
df$Game2_2_2[df$Game2_2_2=="۱۵"] <- "15"
df$Game2_2_2[df$Game2_2_2=="٢٠"] <- "20"
df$Game2_2_2[df$Game2_2_2=="٢٥"] <- "25"
df$Game2_2_2[df$Game2_2_2=="٣٠"] <- "30"
df$Game2_2_2[df$Game2_2_2=="۳۰"] <- "30"
df$Game2_2_2[df$Game2_2_2=="٣٥"] <- "35"
df$Game2_2_2[df$Game2_2_2=="٤٠"] <- "40"
df$Game2_2_2[df$Game2_2_2=="٤٥"] <- "45"
df$Game2_2_2[df$Game2_2_2=="٥٠"] <- "50"
df$Game2_2_2[df$Game2_2_2=="٥٥"] <- "55"
df$Game2_2_2[df$Game2_2_2=="٦٠"] <- "60"
df$Game2_2_2[df$Game2_2_2=="٧٠"] <- "70"
df$Game2_2_2[df$Game2_2_2=="٨٠"] <- "80"
df$Game2_2_2[df$Game2_2_2=="١٠٠"] <- "100"
df$Game2_2_2[df$Game2_2_2=="١٥٠"] <- "150"
df$Game2_2_2[df$Game2_2_2=="۵۰۰۰۰"] <- "50000"
df$Game2_2_2[df$Game2_2_2=="۳۰۰۰۰"] <- "30000"
if( any( is.na( as.numeric(df$Game2_2_2) ) ) ) print( "Check Game2_2_2!")
game8 <- data.frame( buyer = 'Stranger',
response = as.numeric(df$Game2_2_2),
market_value )
rbind(
cbind(dat %>% select(subject, all_of(control_variables)),game1),
cbind(dat %>% select(subject, all_of(control_variables)),game2),
cbind(dat %>% select(subject, all_of(control_variables)),game3),
cbind(dat %>% select(subject, all_of(control_variables)),game4),
cbind(dat %>% select(subject, all_of(control_variables)),game5),
cbind(dat %>% select(subject, all_of(control_variables)),game6),
cbind(dat %>% select(subject, all_of(control_variables)),game7),
cbind(dat %>% select(subject, all_of(control_variables)),game8)
) %>% mutate(response = ifelse(response >= market_value, 1, 0))
})
write.csv(data_Game, file = "data_Game.csv")
# Effect found in the original paperå
data_paper <- rbind(
# Buyer
rbind(
# Market Value = 5
data.frame(
market_value = 5, buyer = 'Friend',
response = c(rep(0, round(31*0.68)), rep(5, round(31*0.26)), rep(10, round(31*0.03)))
),
data.frame(
market_value = 5, buyer = 'Friend',
response = c(rep(0, round(28*0.14)), rep(5, round(28*0.79)), rep(10, round(28*0.0)))
),
data.frame(
market_value = 5, buyer = 'Friend',
response = c(rep(0, round(26*0.0)), rep(5, round(26*0.69)), rep(10, round(26*0.23)))
),
# Market Value = 10
data.frame(
market_value = 10, buyer = 'Friend',
response = c(rep(0, round(31*0.66)), rep(5, round(31*0.26)), rep(10, round(31*0.06)))
),
data.frame(
market_value = 10, buyer = 'Friend',
response = c(rep(0, round(28*0.07)), rep(5, round(28*0.79)), rep(10, round(28*0.04)))
),
data.frame(
market_value = 10, buyer = 'Friend',
response = c(rep(0, round(26*0.0)), rep(5, round(26*0.15)), rep(10, round(26*0.69)))
)
),
# Stranger
rbind(
# Market Value = 5
data.frame(
market_value = 5, buyer = 'Stranger',
response = c(rep(0, round(31*0.06)), rep(5, round(31*0.77)), rep(10, round(31*0.10)))
),
data.frame(
market_value = 5, buyer = 'Stranger',
response = c(rep(0, round(28*0.0)), rep(5, round(28*0.79)), rep(10, round(28*0.07)))
),
data.frame(
market_value = 5, buyer = 'Stranger',
response = c(rep(0, round(26*0.0)), rep(5, round(26*0.42)), rep(10, round(26*0.46)))
),
# Market Value = 10
data.frame(
market_value = 10, buyer = 'Stranger',
response = c(rep(0, round(31*0.06)), rep(5, round(31*0.16)), rep(10, round(31*0.58)))
),
data.frame(
market_value = 10, buyer = 'Stranger',
response = c(rep(0, round(28*0.0)), rep(5, round(28*0.14)), rep(10, round(28*0.57)))
),
data.frame(
market_value = 10, buyer = 'Stranger',
response = c(rep(0, round(26*0.0)), rep(5, round(26*0.0)), rep(10, round(26*0.73)))
)
)
) %>%
mutate(response = ifelse(response >= market_value, 1, 0)) %>%
# Calculate ODD RATIO
group_by(buyer, response) %>%
mutate(n = n()) %>% filter(row_number()==1) %>%
group_by(buyer) %>%
mutate(Odds = n[response==1]/n[response==0]) %>%
group_by(buyer) %>%
# filter(Country=="Austria", scenario_group=="gain") %>%
mutate(se_theta = sqrt(sum(1/n))) %>%
filter(row_number()==1) %>% select(-response) %>%
ungroup() %>%
mutate(OR = Odds[buyer=="Stranger"]/Odds[buyer=="Friend"],
theta = log(OR)) %>%
select(-c(OR, Odds, n)) %>% ungroup()
data_paper_Game <- data_paper %>%
mutate(x=3, study="Game", family="binomial") %>%
select(-c(market_value, buyer, se_theta))
# ggplot(data_Game_theta, aes(1, theta, color=Country)) +
#   geom_jitter( aes(size=1/se_theta), width = 0.1, alpha=0.7) +
#   geom_point(data = data_paper, color="firebrick", size=35, shape="-") +
#   geom_hline(yintercept = 0, linetype=2) +
#   theme_pubr() + theme(legend.position = "right") +
#   labs(x=NULL, y=expression(theta)) +
#   scale_color_manual(values = viridis::viridis_pal()(length(unique(data_MrAB$Country)))) +
#   scale_y_continuous(guide = "prism_offset") +
#   scale_size(range = c(3, 8)) +
#   scale_x_continuous(limits = c(0.6,1.4), breaks =c(0.6,1,1.4),guide = "prism_offset") +
#   guides(size = "none") +
#   theme(text = element_text(size = 20), legend.position = "none",
#         axis.text.x=element_blank())
}
################################################################
# -------------------------- Drink --------------------------- #
################################################################
Drink <- TRUE
if( Drink ){
data_Drink <- map_dfr(Countries, function(Country){
print(paste("Processing", Country))
# Link for Austria
lCountry <- Links[Countries==Country]
dat <- read.csv(lCountry) %>% mutate(subject=ResponseId, Country, NativeLanguage=Native.language)
dat$native_language_is_country_language = dat$NativeLanguage%in%NativeLanguageList[[Country]]
if(Country=="Russia"){
dat$Residence <- with( dat, ifelse(Residence=='Russian Federation', Country, Residence) )
} else if( Country=="UK" ){
dat$Residence <- with( dat, ifelse(Residence=='United Kingdom of Great Britain and Northern Ireland', Country, Residence) )
} else if( Country=="USA" ){
dat$Residence <- with( dat, ifelse(Residence=='United States of America', Country, Residence) )
} else if( Country=="Vietnam" ){
dat$Residence <- with( dat, ifelse(Residence=='Viet Nam', Country, Residence) )
}
# Remove first two rows. The first row indicate text presented, the second
# contains Qualtrics relevant variables (e.g. {"ImportId":"QID15_1"})
dat <- dat[3:nrow(dat),]
# Filter subject that finish the experiment and allow to
# use the responses provided in the study
allow <- "I allow you to use the responses I provided in this study."
dat <- dat %>% filter(Debriefing==allow) %>% select(-Debriefing)
names(dat) <- sapply(names(dat), remove_character, pattern=".")
# Create columns indicating attention check
acg3 <- c("Absolutely serious", "Very serious")
acg2 <- c("Absolutely serious", "Very serious", "Moderately serious")
dat <- dat %>% mutate(
attention_check_grater_than_3=ifelse(Att_check%in%acg3, T, F),
attention_check_grater_than_2=ifelse(Att_check%in%acg2, T, F)
) %>% select(-Att_check) %>%
#Create column indicating whether LOI (Length of Interview) of each subjectis lower
# than a third of the median value of LOI
mutate(LOI=as.numeric(Durationinseconds),
loi_lower_than_loiX0_33 = LOI < median( LOI )*0.33) %>%
select(-LOI)  %>%
# Calculate score Financial Literacy
mutate(fin_lit1 = ifelse(str_detect(fin_lit1, "More than"), 1, 0),
fin_lit2 = ifelse(str_detect(fin_lit2, "Less than today"), 1, 0),
fin_lit3 = ifelse(str_detect(fin_lit3, "False"), 1, 0),
fin_lit4 = ifelse(str_detect(fin_lit4, "They collapse"), 1, 0),
FinancialLiteracy =  fin_lit1+fin_lit2+fin_lit3+fin_lit4)
# Create Drink dataseta
dat1 <- dat %>%
select(subject, contains("Drink", ignore.case = FALSE), all_of(control_variables)) %>%
reshape2::melt(id.var=c('subject', control_variables),
variable.name='store',
value.name='response')
# Convert Numbers For Egypt and Iran
persian_position <- is.na(as.numeric(dat1$response)) %>% which()
for( i in persian_position ){
not_collapsed <- sapply(strsplit(dat1$response[i], "")[[1]],
convert_farsi_to_arabic)
dat1$response[i] <- paste(not_collapsed, collapse = "")
}
if( any( is.na(as.numeric(dat1$response)) ) ) print( paste("Check", Country))
dat1 %>%
mutate(store=ifelse(store=='Drink1', 'Resort Hotel', 'Grocery Store'),
response=as.numeric(response))
})
# The 2 warnings: In which(.) : NAs introduced by coercion are fine
# They indicate the non-Arabic numbers coerced in NAs
write.csv(data_Drink, file = "data_Drink.csv")
}
################################################################
# ------------------------- Jacket --------------------------- #
################################################################
Jacket <- TRUE
if( Jacket ){
data_Jacket <- map_dfr(Countries, function(Country){
print(paste("Processing", Country))
# Link for Austria
lCountry <- Links[Countries==Country]
dat <- read.csv(lCountry) %>% mutate(subject=ResponseId, Country, NativeLanguage=Native.language)
dat$native_language_is_country_language = dat$NativeLanguage%in%NativeLanguageList[[Country]]
if(Country=="Russia"){
dat$Residence <- with( dat, ifelse(Residence=='Russian Federation', Country, Residence) )
} else if( Country=="UK" ){
dat$Residence <- with( dat, ifelse(Residence=='United Kingdom of Great Britain and Northern Ireland', Country, Residence) )
} else if( Country=="USA" ){
dat$Residence <- with( dat, ifelse(Residence=='United States of America', Country, Residence) )
} else if( Country=="Vietnam" ){
dat$Residence <- with( dat, ifelse(Residence=='Viet Nam', Country, Residence) )
}
# Remove first two rows. The first row indicate text presented, the second
# contains Qualtrics relevant variables (e.g. {"ImportId":"QID15_1"})
dat <- dat[3:nrow(dat),]
# Filter subject that finish the experiment and allow to
# use the responses provided in the study
allow <- "I allow you to use the responses I provided in this study."
dat <- dat %>% filter(Debriefing==allow) %>% select(-Debriefing)
names(dat) <- sapply(names(dat), remove_character, pattern=".")
# Create columns indicating attention check
acg3 <- c("Absolutely serious", "Very serious")
acg2 <- c("Absolutely serious", "Very serious", "Moderately serious")
dat <- dat %>% mutate(
attention_check_grater_than_3=ifelse(Att_check%in%acg3, T, F),
attention_check_grater_than_2=ifelse(Att_check%in%acg2, T, F)
) %>% select(-Att_check) %>%
#Create column indicating whether LOI (Length of Interview) of each subjectis lower
# than a third of the median value of LOI
mutate(LOI=as.numeric(Durationinseconds),
loi_lower_than_loiX0_33 = LOI < median( LOI )*0.33) %>%
select(-LOI) %>%
# Calculate score Financial Literacy
mutate(fin_lit1 = ifelse(str_detect(fin_lit1, "More than"), 1, 0),
fin_lit2 = ifelse(str_detect(fin_lit2, "Less than today"), 1, 0),
fin_lit3 = ifelse(str_detect(fin_lit3, "False"), 1, 0),
fin_lit4 = ifelse(str_detect(fin_lit4, "They collapse"), 1, 0),
FinancialLiteracy =  fin_lit1+fin_lit2+fin_lit3+fin_lit4)
# Create Jacket dataseta
dat %>%
select(subject, contains("Jacket", ignore.case = FALSE), all_of(control_variables)) %>%
reshape2::melt(id.var=c('subject', control_variables),
variable.name='price',
value.name='response') %>%
mutate(price=ifelse(price=="Jacket1", "low", "high"),
response=ifelse(response=="Yes", 1, 0))
})
write.csv(data_Jacket, file = "data_Jacket.csv")
# Paper: Kahneman, D., & Tversky, A. (1984). Choices, values, and frames.
# American Psychologist, 39(4), 341–350. https://doi.org/10.1037/0003-066X.39.4.341
n_sbj = 88
a     = round(n_sbj*0.68)
b     = n_sbj-a
odds1 = a/b
n_sbj = 93
c     = round(n_sbj*0.29)
d     = n_sbj-c
odds2 = c/d
OR = odds1/odds2
theta = log(OR)
data_paper_Jacket <- data.frame(
x=4, study="Jacket", family="binomial", theta
)
# ggplot(data_Jacket_theta, aes(1, theta, color=Country)) +
#   geom_jitter( aes(size=1/se_theta), width = 0.1, alpha=0.7) +
#   # geom_point(data = data_paper, color="firebrick", size=35, shape="-") +
#   geom_hline(yintercept = 0, linetype=2) +
#   theme_pubr() + theme(legend.position = "right") +
#   labs(x=NULL, y=expression(theta)) +
#   scale_color_manual(values = viridis::viridis_pal()(length(unique(data_MrAB$Country)))) +
#   scale_y_continuous(guide = "prism_offset") +
#   scale_size(range = c(3, 8)) +
#   scale_x_continuous(limits = c(0.6,1.4), breaks =c(0.6,1,1.4),guide = "prism_offset") +
#   guides(size = "none") +
#   theme(text = element_text(size = 20), legend.position = "none",
#         axis.text.x=element_blank())
}
################################################################
# -------------------------- Play ---------------------------- #
################################################################
Play <- TRUE
if( Play ){
data_Play <- map_dfr(Countries, function(Country){
print(paste("Processing", Country))
# Link for Austria
lCountry <- Links[Countries==Country]
dat <- read.csv(lCountry) %>% mutate(subject=ResponseId, Country, NativeLanguage=Native.language)
dat$native_language_is_country_language = dat$NativeLanguage%in%NativeLanguageList[[Country]]
if(Country=="Russia"){
dat$Residence <- with( dat, ifelse(Residence=='Russian Federation', Country, Residence) )
} else if( Country=="UK" ){
dat$Residence <- with( dat, ifelse(Residence=='United Kingdom of Great Britain and Northern Ireland', Country, Residence) )
} else if( Country=="USA" ){
dat$Residence <- with( dat, ifelse(Residence=='United States of America', Country, Residence) )
} else if( Country=="Vietnam" ){
dat$Residence <- with( dat, ifelse(Residence=='Viet Nam', Country, Residence) )
}
# Remove first two rows. The first row indicate text presented, the second
# contains Qualtrics relevant variables (e.g. {"ImportId":"QID15_1"})
dat <- dat[3:nrow(dat),]
# Filter subject that finish the experiment and allow to
# use the responses provided in the study
allow <- "I allow you to use the responses I provided in this study."
dat <- dat %>% filter(Debriefing==allow) %>% select(-Debriefing)
names(dat) <- sapply(names(dat), remove_character, pattern=".")
# Create columns indicating attention check
acg3 <- c("Absolutely serious", "Very serious")
acg2 <- c("Absolutely serious", "Very serious", "Moderately serious")
dat <- dat %>% mutate(
attention_check_grater_than_3=ifelse(Att_check%in%acg3, T, F),
attention_check_grater_than_2=ifelse(Att_check%in%acg2, T, F)
) %>% select(-Att_check) %>%
#Create column indicating whether LOI (Length of Interview) of each subjectis lower
# than a third of the median value of LOI
mutate(LOI=as.numeric(Durationinseconds),
loi_lower_than_loiX0_33 = LOI < median( LOI )*0.33) %>%
select(-LOI) %>%
# Calculate score Financial Literacy
mutate(fin_lit1 = ifelse(str_detect(fin_lit1, "More than"), 1, 0),
fin_lit2 = ifelse(str_detect(fin_lit2, "Less than today"), 1, 0),
fin_lit3 = ifelse(str_detect(fin_lit3, "False"), 1, 0),
fin_lit4 = ifelse(str_detect(fin_lit4, "They collapse"), 1, 0),
FinancialLiteracy =  fin_lit1+fin_lit2+fin_lit3+fin_lit4)
# Create Play data set
dat %>%
select(subject, contains("Play", ignore.case = FALSE), all_of(control_variables)) %>%
reshape2::melt(id.var=c('subject', control_variables),
variable.name='loss',
value.name='response') %>%
mutate(loss=ifelse(loss=="Play1", "ticket", "cash"),
response=ifelse(response=="Yes", 1, 0))
})
write.csv(data_Play, file = "data_Play.csv")
# Tversky, A., & Kahneman, D. (1981). The framing of decisions and the psychology of choice.
# Science, 211(4481), 453–458. https://doi.org/10.1126/science.7455683
n_sbj = 183
a     = round(n_sbj*0.88)
b     = n_sbj-a
odds1 = a/b
n_sbj = 200
c     = round(n_sbj*0.46)
d     = n_sbj-c
odds2 = c/d
OR = odds1/odds2
theta = log(OR)
data_paper_Play <- data.frame(
x=5, study="Play", family="binomial", theta
)
}
################################################################
# -------------------------- Gym ----------------------------- #
################################################################
Gym <- TRUE
if( Gym ){
data_Gym <- map_dfr(Countries, function(Country){
print(paste("Processing", Country))
# Link for Austria
lCountry <- Links[Countries==Country]
dat <- read.csv(lCountry) %>% mutate(subject=ResponseId, Country, NativeLanguage=Native.language)
dat$native_language_is_country_language = dat$NativeLanguage%in%NativeLanguageList[[Country]]
if(Country=="Russia"){
dat$Residence <- with( dat, ifelse(Residence=='Russian Federation', Country, Residence) )
} else if( Country=="UK" ){
dat$Residence <- with( dat, ifelse(Residence=='United Kingdom of Great Britain and Northern Ireland', Country, Residence) )
} else if( Country=="USA" ){
dat$Residence <- with( dat, ifelse(Residence=='United States of America', Country, Residence) )
} else if( Country=="Vietnam" ){
dat$Residence <- with( dat, ifelse(Residence=='Viet Nam', Country, Residence) )
}
# Remove first two rows. The first row indicate text presented, the second
# contains Qualtrics relevant variables (e.g. {"ImportId":"QID15_1"})
dat <- dat[3:nrow(dat),]
# Filter subject that finish the experiment and allow to
# use the responses provided in the study
allow <- "I allow you to use the responses I provided in this study."
dat <- dat %>% filter(Debriefing==allow) %>% select(-Debriefing)
names(dat) <- sapply(names(dat), remove_character, pattern=".")
# Create columns indicating attention check
acg3 <- c("Absolutely serious", "Very serious")
acg2 <- c("Absolutely serious", "Very serious", "Moderately serious")
dat <- dat %>% mutate(
attention_check_grater_than_3=ifelse(Att_check%in%acg3, T, F),
attention_check_grater_than_2=ifelse(Att_check%in%acg2, T, F)
) %>% select(-Att_check) %>%
#Create column indicating whether LOI (Length of Interview) of each subjectis lower
# than a third of the median value of LOI
mutate(LOI=as.numeric(Durationinseconds),
loi_lower_than_loiX0_33 = LOI < median( LOI )*0.33) %>%
select(-LOI) %>%
# Calculate score Financial Literacy
mutate(fin_lit1 = ifelse(str_detect(fin_lit1, "More than"), 1, 0),
fin_lit2 = ifelse(str_detect(fin_lit2, "Less than today"), 1, 0),
fin_lit3 = ifelse(str_detect(fin_lit3, "False"), 1, 0),
fin_lit4 = ifelse(str_detect(fin_lit4, "They collapse"), 1, 0),
FinancialLiteracy =  fin_lit1+fin_lit2+fin_lit3+fin_lit4)
# Create Play data set
dat %>%
select(subject, contains("Gym1_1", ignore.case = FALSE),
contains("Gym2_1", ignore.case = FALSE), all_of(control_variables)) %>%
reshape2::melt(id.var=c('subject', control_variables),
variable.name='frame',
value.name='response') %>%
mutate(frame=ifelse(frame=="Gym1_1", "Per-session", "Yearly"),
response=ifelse(grepl("Strongly agree", response), "1", response),
response=ifelse(grepl("Strongly disagree", response), "5", response),
response=as.numeric(response))
})
write.csv(data_Gym, file = "data_Gym.csv")
}
################################################################
# -------------------------- Plane ---------------------------- #
################################################################
Plane <- TRUE
if( Plane ){
data_Plane <- map_dfr(Countries, function(Country){
print(paste("Processing", Country))
# Link for Austria
lCountry <- Links[Countries==Country]
dat <- read.csv(lCountry) %>% mutate(subject=ResponseId, Country, NativeLanguage=Native.language)
dat$native_language_is_country_language = dat$NativeLanguage%in%NativeLanguageList[[Country]]
if(Country=="Russia"){
dat$Residence <- with( dat, ifelse(Residence=='Russian Federation', Country, Residence) )
} else if( Country=="UK" ){
dat$Residence <- with( dat, ifelse(Residence=='United Kingdom of Great Britain and Northern Ireland', Country, Residence) )
} else if( Country=="USA" ){
dat$Residence <- with( dat, ifelse(Residence=='United States of America', Country, Residence) )
} else if( Country=="Vietnam" ){
dat$Residence <- with( dat, ifelse(Residence=='Viet Nam', Country, Residence) )
}
# Remove first two rows. The first row indicate text presented, the second
# contains Qualtrics relevant variables (e.g. {"ImportId":"QID15_1"})
dat <- dat[3:nrow(dat),]
# Filter subject that finish the experiment and allow to
# use the responses provided in the study
allow <- "I allow you to use the responses I provided in this study."
dat <- dat %>% filter(Debriefing==allow) %>% select(-Debriefing)
names(dat) <- sapply(names(dat), remove_character, pattern=".")
# Create columns indicating attention check
acg3 <- c("Absolutely serious", "Very serious")
acg2 <- c("Absolutely serious", "Very serious", "Moderately serious")
dat <- dat %>% mutate(
attention_check_grater_than_3=ifelse(Att_check%in%acg3, T, F),
attention_check_grater_than_2=ifelse(Att_check%in%acg2, T, F)
) %>% select(-Att_check) %>%
#Create column indicating whether LOI (Length of Interview) of each subjectis lower
# than a third of the median value of LOI
mutate(LOI=as.numeric(Durationinseconds),
loi_lower_than_loiX0_33 = LOI < median( LOI )*0.33) %>%
select(-LOI) %>%
# Calculate score Financial Literacy
mutate(fin_lit1 = ifelse(str_detect(fin_lit1, "More than"), 1, 0),
fin_lit2 = ifelse(str_detect(fin_lit2, "Less than today"), 1, 0),
fin_lit3 = ifelse(str_detect(fin_lit3, "False"), 1, 0),
fin_lit4 = ifelse(str_detect(fin_lit4, "They collapse"), 1, 0),
FinancialLiteracy =  fin_lit1+fin_lit2+fin_lit3+fin_lit4)
answers = c(
'Pay your friend',
'Pay some, but not',
'Consider it a gift'
)
# Create Play data set
dat <- dat %>%
select(subject, contains("Plane", ignore.case = FALSE), all_of(control_variables))
dat$Plane1[grepl(answers[1],dat$Plane1)] <- "1"
dat$Plane1[grepl(answers[2],dat$Plane1)] <- "0"
dat$Plane1[grepl(answers[3],dat$Plane1)] <- "0"
dat$Plane2[grepl(answers[1],dat$Plane2)] <- "1"
dat$Plane2[grepl(answers[2],dat$Plane2)] <- "0"
dat$Plane2[grepl(answers[3],dat$Plane2)] <- "0"
dat %>%
rename(purchased = Plane1,
free = Plane2) %>%
reshape2::melt(id.var=c('subject', control_variables),
variable.name='coupon',
value.name='response') %>%
mutate(response=as.numeric(response))
})
write.csv(data_Plane, file = "data_Plane.csv")
# Shafir, E., & Thaler, R. H. (2006). Invest now, drink later,
# spend never: On the mental accounting of delayed consumption.
# Journal of economic psychology, 27(5), 694-712.
n_sbj = 57
a     = round(n_sbj*0.25)
b     = n_sbj-a
odds1 = a/b
n_sbj = 58
c     = round(n_sbj*0.05)
d     = n_sbj-c
odds2 = c/d
OR = odds1/odds2
theta = log(OR)
data_paper_Plane <- data.frame(
x=6, study="Plane", family="binomial", theta
)
}
################################################################
# ----------- Effect Size of the original papers ------------- #
################################################################
original_theta <- list(
MrAB = data_paper_MrAB,
Game = data_paper_Game,
Jacket = data_paper_Jacket,
Play = data_paper_Play,
Plane = data_paper_Plane
)
saveRDS(original_theta, file = "original_theta.rds")
