# Long
geom_point(data=data_lg_s2,
aes(response, n, color=buyer),
size=3) +
geom_line(data=data_lg_s2,
aes(response, n, group=buyer, color=buyer),
size=1) +
mytheme() + theme(legend.position= 'top', plot.caption = element_text(hjust = 0) ) +
scale_color_jcolors(palette = 'pal6') +
labs(y='Response count', x=NULL, title='long') +
facet_grid(cost~market_value) )
(pl2 <- plot_grid(pl2_long, pl2_short, nrow=1))
title <- ggdraw() +
draw_label(
'“Game” scenarios',
x = 0.33,size = 25,
hjust = 0
) +
theme(
# add margin on the left of the drawing canvas,
# so title is aligned with left edge of first plot
plot.margin = margin(0, 0, 0, 7)
)
pll2 <- plot_grid(
title, pl2,
ncol = 1,
# rel_heights values control vertical title margins
rel_heights = c(0.1, 1), labels = 'B'
)
ggsave(file="s2.png", plot=pll2, width=8, height=4)
(pl1 <- rbind(dt_sh_s1, dt_lg_s1) %>%
ggplot(aes(response, count, color=scenario)) +
scale_fill_brewer(palette = 'Set1') +
scale_color_brewer(palette = 'Set1') +
geom_point(size=3) +
geom_line(aes(group=scenario, color=scenario), size=1) +
mytheme() + labs(y='Response count', x=NULL,
title = '“MrAB” scenarios',
caption='The four colors indicate in the different scenarios. \nIn this plot, as well as in all the other plots below, \nthe long version is shown on the left, while the \nshort version is shown on the right.') +
facet_grid(~type) +
theme(legend.position='right', plot.caption = element_text(hjust = 0)) +
scale_x_continuous(breaks = 1:3, labels = c('A', 'B', 'Same'),
limits= c(0.5, 3.5) ))
pl1 <- plot_grid(pl1, labels = 'A')
ggsave(file="s1.png", plot=pl1, width=6, height=3)
(pl1 <- rbind(dt_sh_s1, dt_lg_s1) %>%
ggplot(aes(response, count, color=scenario)) +
scale_fill_brewer(palette = 'Set1') +
scale_color_brewer(palette = 'Set1') +
geom_point(size=3) +
geom_line(aes(group=scenario, color=scenario), size=1) +
mytheme() + labs(y='Response count', x=NULL,
title = '“MrAB” scenarios',
caption='The four colors indicate in the different scenarios. \nThe long version is shown on the left, while the \nshort version is shown on the right.') +
facet_grid(~type) +
theme(legend.position='right', plot.caption = element_text(hjust = 0)) +
scale_x_continuous(breaks = 1:3, labels = c('A', 'B', 'Same'),
limits= c(0.5, 3.5) ))
pl1 <- plot_grid(pl1, labels = 'A')
ggsave(file="s1.png", plot=pl1, width=6, height=3)
pl1
(pl2_short <- ggplot() +
# Short
geom_point(data=data_sh_s2,
aes(response, n, color=buyer),
shape=16, size=3) +
geom_line(data=data_sh_s2,
aes(response, n, group=buyer, color=buyer),
size=1) +
# Long
# geom_point(data=data_lg_s2,
#            aes(response, n, color=buyer),
#            shape=17, size=3) +
# geom_line(data=data_lg_s2,
#           aes(response, n, group=buyer, color=buyer),
#           size=1, linetype=2) +
mytheme() + theme(legend.position= 'top', plot.caption = element_text(hjust = 0) ) +
scale_color_jcolors(palette = 'pal6') +
labs(y='Response count', x=NULL, title='short', caption = 'The long version is shown on the left, while the \nshort version is shown on the right.') +
facet_grid(cost~market_value))
(pl2_long <- ggplot() +
# Long
geom_point(data=data_lg_s2,
aes(response, n, color=buyer),
size=3) +
geom_line(data=data_lg_s2,
aes(response, n, group=buyer, color=buyer),
size=1) +
mytheme() + theme(legend.position= 'top', plot.caption = element_text(hjust = 0) ) +
scale_color_jcolors(palette = 'pal6') +
labs(y='Response count', x=NULL, title='long', caption='The long version is shown on the left, while the \nshort version is shown on the right.') +
facet_grid(cost~market_value) )
(pl2 <- plot_grid(pl2_long, pl2_short, nrow=1))
title <- ggdraw() +
draw_label(
'“Game” scenarios',
x = 0.33,size = 25,
hjust = 0
) +
theme(
# add margin on the left of the drawing canvas,
# so title is aligned with left edge of first plot
plot.margin = margin(0, 0, 0, 7)
)
pll2 <- plot_grid(
title, pl2,
ncol = 1,
# rel_heights values control vertical title margins
rel_heights = c(0.1, 1), labels = 'B'
)
ggsave(file="s2.png", plot=pll2, width=8, height=4)
(pl2_short <- ggplot() +
# Short
geom_point(data=data_sh_s2,
aes(response, n, color=buyer),
shape=16, size=3) +
geom_line(data=data_sh_s2,
aes(response, n, group=buyer, color=buyer),
size=1) +
# Long
# geom_point(data=data_lg_s2,
#            aes(response, n, color=buyer),
#            shape=17, size=3) +
# geom_line(data=data_lg_s2,
#           aes(response, n, group=buyer, color=buyer),
#           size=1, linetype=2) +
mytheme() + theme(legend.position= 'top', plot.caption = element_text(hjust = 0) ) +
scale_color_jcolors(palette = 'pal6') +
labs(y='Response count', x=NULL, title='short', caption = 'Here is shown the hort version is shown on the right.') +
facet_grid(cost~market_value))
(pl2_short <- ggplot() +
# Short
geom_point(data=data_sh_s2,
aes(response, n, color=buyer),
shape=16, size=3) +
geom_line(data=data_sh_s2,
aes(response, n, group=buyer, color=buyer),
size=1) +
# Long
# geom_point(data=data_lg_s2,
#            aes(response, n, color=buyer),
#            shape=17, size=3) +
# geom_line(data=data_lg_s2,
#           aes(response, n, group=buyer, color=buyer),
#           size=1, linetype=2) +
mytheme() + theme(legend.position= 'top', plot.caption = element_text(hjust = 0) ) +
scale_color_jcolors(palette = 'pal6') +
labs(y='Response count', x=NULL, title='short', caption = 'Here is shown the hort version is shown on the right.') +
facet_grid(cost~market_value))
(pl2_long <- ggplot() +
# Long
geom_point(data=data_lg_s2,
aes(response, n, color=buyer),
size=3) +
geom_line(data=data_lg_s2,
aes(response, n, group=buyer, color=buyer),
size=1) +
mytheme() + theme(legend.position= 'top', plot.caption = element_text(hjust = 0) ) +
scale_color_jcolors(palette = 'pal6') +
labs(y='Response count', x=NULL, title='long', caption='Here is shown the long version.') +
facet_grid(cost~market_value) )
(pl2 <- plot_grid(pl2_long, pl2_short, nrow=1))
title <- ggdraw() +
draw_label(
'“Game” scenarios',
x = 0.33,size = 25,
hjust = 0
) +
theme(
# add margin on the left of the drawing canvas,
# so title is aligned with left edge of first plot
plot.margin = margin(0, 0, 0, 7)
)
pll2 <- plot_grid(
title, pl2,
ncol = 1,
# rel_heights values control vertical title margins
rel_heights = c(0.1, 1), labels = 'B'
)
ggsave(file="s2.png", plot=pll2, width=8, height=4.5)
(pl2_short <- ggplot() +
# Short
geom_point(data=data_sh_s2,
aes(response, n, color=buyer),
shape=16, size=3) +
geom_line(data=data_sh_s2,
aes(response, n, group=buyer, color=buyer),
size=1) +
# Long
# geom_point(data=data_lg_s2,
#            aes(response, n, color=buyer),
#            shape=17, size=3) +
# geom_line(data=data_lg_s2,
#           aes(response, n, group=buyer, color=buyer),
#           size=1, linetype=2) +
mytheme() + theme(legend.position= 'top', plot.caption = element_text(hjust = 0) ) +
scale_color_jcolors(palette = 'pal6') +
labs(y='Response count', x=NULL, title='short', caption = 'Here is shown the short version.') +
facet_grid(cost~market_value))
(pl2_long <- ggplot() +
# Long
geom_point(data=data_lg_s2,
aes(response, n, color=buyer),
size=3) +
geom_line(data=data_lg_s2,
aes(response, n, group=buyer, color=buyer),
size=1) +
mytheme() + theme(legend.position= 'top', plot.caption = element_text(hjust = 0) ) +
scale_color_jcolors(palette = 'pal6') +
labs(y='Response count', x=NULL, title='long', caption='Here is shown the long version.') +
facet_grid(cost~market_value) )
(pl2 <- plot_grid(pl2_long, pl2_short, nrow=1))
title <- ggdraw() +
draw_label(
'“Game” scenarios',
x = 0.33,size = 25,
hjust = 0
) +
theme(
# add margin on the left of the drawing canvas,
# so title is aligned with left edge of first plot
plot.margin = margin(0, 0, 0, 7)
)
pll2 <- plot_grid(
title, pl2,
ncol = 1,
# rel_heights values control vertical title margins
rel_heights = c(0.1, 1), labels = 'B'
)
ggsave(file="s2.png", plot=pll2, width=8, height=4.5)
ggsave(file="s2.png", plot=pll2, width=8, height=5)
( pl3 <- rbind( data_sh_s3, data_lg_s3 )  %>%
group_by(store, type) %>%
summarise(response = mean(response)) %>%
ggplot(aes(store, response, color = type)) +
scale_fill_brewer(palette = 'Set1') +
scale_color_brewer(palette = 'Set1') +
geom_point(color='black', size=3) +
geom_line(color='black', aes(group=type), size=1) +
mytheme() + theme(legend.position = 'none') +
facet_wrap(~type) +
labs(y='Mean response', x='Store', title = '“Drink” scenarios') )
# Create dataframe scenario 3
data_sh_s3 <- data_short_MA %>%
select(subject, contains("C", ignore.case = FALSE)) %>%
melt(id.var = "subject", variable.name = "store", value.name = "response") %>%
mutate(store = ifelse(store == "C1_1", "Resort\nHotel", "Grocery\nStore"),
response = as.numeric(response),
type = 'short')
data_lg_s3 <- data_long_MA %>%
select(subject, contains("C", ignore.case = FALSE)) %>%
melt(id.var = "subject", variable.name = "store", value.name = "response") %>%
mutate(store = ifelse(store == "C1_1", "Resort\nHotel", "Grocery\nStore"),
response = as.numeric(response),
type= 'long')
( pl3 <- rbind( data_sh_s3, data_lg_s3 )  %>%
group_by(store, type) %>%
summarise(response = mean(response)) %>%
ggplot(aes(store, response, color = type)) +
scale_fill_brewer(palette = 'Set1') +
scale_color_brewer(palette = 'Set1') +
geom_point(color='black', size=3) +
geom_line(color='black', aes(group=type), size=1) +
mytheme() + theme(legend.position = 'none') +
facet_wrap(~type) +
labs(y='Mean response', x='Store', title = '“Drink” scenarios') )
pl3 <- plot_grid(pl3, labels = 'C')
( pl3 <- rbind( data_sh_s3, data_lg_s3 )  %>%
group_by(store, type) %>%
summarise(response = mean(response)) %>%
ggplot(aes(store, response, color = type)) +
scale_fill_brewer(palette = 'Set1') +
scale_color_brewer(palette = 'Set1') +
geom_point(color='black', size=3) +
geom_line(color='black', aes(group=type), size=1) +
mytheme() + theme(legend.position = 'none') +
facet_wrap(~type) +
labs(y='Mean response', x='Store', title = '“Drink” scenarios',
caption='The long version is shown on the left, while the \nshort version is shown on the right.' ) )
( pl3 <- rbind( data_sh_s3, data_lg_s3 )  %>%
group_by(store, type) %>%
summarise(response = mean(response)) %>%
ggplot(aes(store, response, color = type)) +
scale_fill_brewer(palette = 'Set1') +
scale_color_brewer(palette = 'Set1') +
geom_point(color='black', size=3) +
geom_line(color='black', aes(group=type), size=1) +
mytheme() + theme(legend.position = 'none', plot.caption = element_text(hjust = 0)) +
facet_wrap(~type) +
labs(y='Mean response', x='Store', title = '“Drink” scenarios',
caption='The long version is shown on the left, while the \nshort version is shown on the right.' ) )
pl3 <- plot_grid(pl3, labels = 'C')
ggsave(file="s3.png", plot=pl3, width=4.3, height=2.7)
ggsave(file="s3.png", plot=pl3, width=4.3, height=3.7)
ggsave(file="s3.png", plot=pl3, width=4.3, height=3.5)
ggsave(file="s3.png", plot=pl3, width=4.3, height=3.3)
(pl4 <- rbind( data_sh_s4, data_lg_s4) %>%
ggplot(aes(price, n)) +
# geom_bar(stat = 'identity',
#          position=position_dodge()) +
scale_fill_brewer(palette = 'Set1') +
scale_color_brewer(palette = 'Set1') +
geom_point(size=3) +
geom_line(aes(group=type), color='black',size=1) +
mytheme() + theme(legend.position = 'none', plot.caption = element_text(hjust = 0)) +
facet_wrap(~type) +
labs(y='Number of "Yes"', x='Price', title='“Jacket” scenarios',
caption='The long version is shown on the left, while the \nshort version is shown on the right.' ))
# ----------- Scenario 4 ----------- #
data_sh_s4 <- data_short_MA %>%
select(subject, contains('D', ignore.case = FALSE)) %>%
rename(low_price2 = D3, low_price1 = D2_1,
high_price2 = D4, high_price1 = D2_2) %>%
melt(id.var='subject',
variable.name='price',
value.name='response') %>%
mutate(price=ifelse(str_detect(price, 'low'), 'Low', 'High'),
response=ifelse(response=='No', 1, 2)) %>%
filter(response==2) %>%
group_by(price) %>%
count(response, .drop = F) %>%
ungroup() %>%
mutate(type='short')
data_lg_s4 <- data_long_MA %>%
select(subject, contains('D', ignore.case = FALSE)) %>%
rename(low_price2 = D3, low_price1 = D2_1,
high_price2 = D4, high_price1 = D2_2) %>%
melt(id.var='subject',
variable.name='price',
value.name='response') %>%
mutate(price=ifelse(str_detect(price, 'low'), 'Low', 'High')) %>%
filter(response==1) %>%
group_by(price) %>%
count(response, .drop = F) %>%
ungroup() %>%
mutate(type='long')
(pl4 <- rbind( data_sh_s4, data_lg_s4) %>%
ggplot(aes(price, n)) +
# geom_bar(stat = 'identity',
#          position=position_dodge()) +
scale_fill_brewer(palette = 'Set1') +
scale_color_brewer(palette = 'Set1') +
geom_point(size=3) +
geom_line(aes(group=type), color='black',size=1) +
mytheme() + theme(legend.position = 'none', plot.caption = element_text(hjust = 0)) +
facet_wrap(~type) +
labs(y='Number of "Yes"', x='Price', title='“Jacket” scenarios',
caption='The long version is shown on the left, while the \nshort version is shown on the right.' ))
pl4 <- plot_grid(pl4, labels = 'D')
ggsave(file="s4.png", plot=pl4, width=4.3, height=2.7)
ggsave(file="s4.png", plot=pl4, width=4.3, height=3.3)
( pl5 <- rbind( data_sh_s5, data_lg_s5) %>%
ggplot(aes(loss, n)) +
# geom_bar(stat = 'identity',
#          position=position_dodge()) +
scale_fill_brewer(palette = 'Set1') +
scale_color_brewer(palette = 'Set1') +
geom_point(size=3) +
geom_line(aes(group=type), size=1) +
mytheme() + theme(legend.position = 'none', plot.caption = element_text(hjust = 0)) +
facet_wrap(~type)+
labs(y='Number of "Yes"', x='Loss', title='“Play” scenarios',
caption='The long version is shown on the left, while the \nshort version is shown on the right.' ) )
pl5 <- plot_grid(pl5, labels = 'E')
# ----------- Scenario 5 ----------- #
data_sh_s5 <- data_short_MA %>%
select(subject, contains('E', ignore.case = FALSE)) %>%
rename(Ticket = E1,
Cash = E2) %>%
melt(id.var='subject',
variable.name='loss',
value.name='response') %>%
mutate(response=ifelse(response=='No', 1, 2)) %>%
filter(response==2) %>%
group_by(loss) %>%
count(response, .drop = F) %>%
ungroup() %>%
mutate(type='short')
data_lg_s5 <- data_long_MA %>%
select(subject, contains('E', ignore.case = FALSE)) %>%
rename(Ticket = E1,
Cash = E2) %>%
melt(id.var='subject',
variable.name='loss',
value.name='response') %>%
filter(response==1) %>%
group_by(loss) %>%
count(response, .drop = F) %>%
ungroup() %>%
mutate(type='long')
( pl5 <- rbind( data_sh_s5, data_lg_s5) %>%
ggplot(aes(loss, n)) +
# geom_bar(stat = 'identity',
#          position=position_dodge()) +
scale_fill_brewer(palette = 'Set1') +
scale_color_brewer(palette = 'Set1') +
geom_point(size=3) +
geom_line(aes(group=type), size=1) +
mytheme() + theme(legend.position = 'none', plot.caption = element_text(hjust = 0)) +
facet_wrap(~type)+
labs(y='Number of "Yes"', x='Loss', title='“Play” scenarios',
caption='The long version is shown on the left, while the \nshort version is shown on the right.' ) )
pl5 <- plot_grid(pl5, labels = 'E')
ggsave(file="s5.png", plot=pl5, width=4.3, height=2.7)
ggsave(file="s5.png", plot=pl5, width=4.3, height=3.3)
( pl6 <- rbind( data_sh_s6, data_lg_s6) %>%
ggplot(aes(frame, n)) +
# geom_bar(stat = 'identity',
#          position=position_dodge()) +
scale_fill_brewer(palette = 'Set1') +
scale_color_brewer(palette = 'Set1') +
geom_point(aes(shape=type), size=3) +
geom_line(aes(group=type), size=1) +
mytheme() + theme(legend.position = 'none', plot.caption = element_text(hjust = 0)) +
facet_wrap(~type)+
labs(y="Number of \"Wasted $20\"", x='Frame', title='“Gym” scenarios',
caption='The long version is shown on the left, while the \nshort version is shown on the right.' ) )
pl6 <- plot_grid(pl6, labels = 'F')
# ----------- Scenario 6 ----------- #
answers = c("I feel like I wasted $20", "I feel like I wasted something but no specific amount or measure comes to mind",
"I feel like I wasted nothing, since my visit had already been paid for")
data_sh_s6 <- data_short_MA %>%
select(subject, contains("F", ignore.case = FALSE)) %>%
mutate(F1 = case_when(F1 == answers[1] ~ 1,
F1 == answers[2] ~ 0,
F1 == answers[3] ~ 0),
F2 = case_when(F2 == answers[1] ~ 1,
F2 == answers[2] ~ 0,
F2 == answers[3] ~ 0)) %>%
rename(`Per-session` = F1, Yearly = F2) %>%
melt(id.var = "subject", variable.name = "frame", value.name = "response") %>%
filter(response == 1) %>%
group_by(frame) %>%
count(response, .drop = F) %>%
ungroup() %>%
mutate(type='short')
data_lg_s6 <- data_long_MA %>%
select(subject, contains("F", ignore.case = FALSE)) %>%
mutate(F1 = ifelse( F1==1, 1, 0),
F2 = ifelse( F2==1, 1, 0)) %>%
rename(`Per-session` = F1, Yearly = F2) %>%
melt(id.var = "subject", variable.name = "frame", value.name = "response") %>%
filter(response == 1) %>%
group_by(frame) %>%
count(response, .drop = F) %>%
ungroup() %>%
mutate(type='long')
( pl6 <- rbind( data_sh_s6, data_lg_s6) %>%
ggplot(aes(frame, n)) +
# geom_bar(stat = 'identity',
#          position=position_dodge()) +
scale_fill_brewer(palette = 'Set1') +
scale_color_brewer(palette = 'Set1') +
geom_point(aes(shape=type), size=3) +
geom_line(aes(group=type), size=1) +
mytheme() + theme(legend.position = 'none', plot.caption = element_text(hjust = 0)) +
facet_wrap(~type)+
labs(y="Number of \"Wasted $20\"", x='Frame', title='“Gym” scenarios',
caption='The long version is shown on the left, while the \nshort version is shown on the right.' ) )
pl6 <- plot_grid(pl6, labels = 'F')
ggsave(file="s6.png", plot=pl6, width=4.3, height=3.3)
# ----------- Scenario 7 ----------- #
answers = c("Pay your friend $35 for the coupon.",
"Pay some, but not the full amount for the coupon (for example, half the price).",
"Consider it a gift and not pay for the coupon.")
data_sh_s7 <- data_short_MA %>%
select(subject, contains("G", ignore.case = FALSE)) %>%
mutate(G1 = case_when(G1 == answers[1] ~ 1, G1 == answers[2] ~ 0, G1 == answers[3] ~
0), G2 = case_when(G2 == answers[1] ~ 1, G2 == answers[2] ~ 0, G2 == answers[3] ~
0)) %>%
rename(Purchased = G1, Free = G2) %>%
melt(id.var = "subject", variable.name = "coupon", value.name = "response") %>%
filter(response == 1) %>%
group_by(coupon) %>%
count(response, .drop = F) %>%
ungroup()%>%
ungroup() %>%
mutate(type='short')
data_lg_s7 <- data_long_MA %>%
select(subject, contains("G", ignore.case = FALSE)) %>%
mutate(G1 = ifelse( G1==1, 1, 0),
G2 = ifelse( G2==1, 1, 0)) %>%
rename(Purchased = G1, Free = G2) %>%
melt(id.var = "subject", variable.name = "coupon", value.name = "response") %>%
filter(response == 1) %>%
group_by(coupon) %>%
count(response, .drop = F) %>%
ungroup()%>%
ungroup() %>%
mutate(type='long')
( pl7 <- rbind( data_sh_s7, data_lg_s7) %>%
ggplot(aes(coupon, n)) +
scale_fill_brewer(palette = 'Set1') +
scale_color_brewer(palette = 'Set1') +
geom_point(size=3) +
geom_line(aes(group=type), size=1) +
mytheme() + theme(legend.position = 'none') +
facet_wrap(~type) +
labs(y='Number of “Pay $35”', x='Coupon', title='“Plane” scenarios') )
pl7 <- plot_grid(pl7, labels = 'G')
( pl7 <- rbind( data_sh_s7, data_lg_s7) %>%
ggplot(aes(coupon, n)) +
scale_fill_brewer(palette = 'Set1') +
scale_color_brewer(palette = 'Set1') +
geom_point(size=3) +
geom_line(aes(group=type), size=1) +
mytheme() + theme(legend.position = 'none', plot.caption = element_text(hjust = 0)) +
facet_wrap(~type) +
labs(y='Number of “Pay $35”', x='Coupon', title='“Plane” scenarios',
caption='The long version is shown on the left, while the \nshort version is shown on the right.' ) )
pl7 <- plot_grid(pl7, labels = 'G')
ggsave(file="s7.png", plot=pl7, width=4.3, height=3.3)
