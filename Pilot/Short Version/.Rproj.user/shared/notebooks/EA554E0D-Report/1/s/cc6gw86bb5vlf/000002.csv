"0",""
"0","# Load libraries"
"0","library(dplyr); library(purrr); library(stringr)"
"0","library(ggplot2); library(ggpubr); library(jcolors)"
"0","library(cowplot); library(ggprism)"
"0","library(reshape2)"
"0",""
"0","# Functions"
"0","words_replace <- function(variable, words_to_replace, replace_with = """") {"
"0",""
"0","    library(dplyr)"
"0","    if (!require(dplyr)) {"
"0","        install.packages(""dplyr"")"
"0","        library(dplyr)"
"0","    }"
"0",""
"0","    # variable <- enquo(variable) var <- select(data, !!variable) %>% .[,]"
"0",""
"0","    if (!is.character(variable))"
"0","        variable <- as.character(variable)"
"0",""
"0","    for (word_i in 1:length(words_to_replace)) {"
"0","        word_to_rm_index <- which(str_detect(variable, fixed(words_to_replace[word_i])))"
"0",""
"0","        if (any(word_to_rm_index)) {"
"0","            words_to_replace_i <- words_to_replace[word_i]"
"0","            new_words <- sapply(seq_along(word_to_rm_index), function(i) {"
"0","                variable[word_to_rm_index][i] <- gsub(words_to_replace_i, replace_with,"
"0","                  variable[word_to_rm_index][i], fixed = TRUE)"
"0","            })"
"0","            variable[word_to_rm_index] <- new_words"
"0","        } else {"
"0","            warning(paste0(""Sting '"", words_to_replace, ""' not found""))"
"0","        }"
"0","    }"
"0",""
"0","    return(variable)"
"0","}"
"0",""
"0","# Load data"
"0","data_short <- readRDS('../Data/data_short.rds')$data %>% "
"0","  mutate(subject=1:n()) %>% "
"0","  rename(age=`Age.`, A3=`A3.`)"
"0",""
"0","questions  <- readRDS('../Data/data_short.rds')$question"
"0",""
"0","# ----- Mental Accounting ----- #"
"0","# Remove final questionnaires"
"0","data_short_MA <- data_short[, -(48:75)]"
"0","# Remove response time"
"0","idx_time      <- str_detect( names(data_short_MA),  'time_')"
"0","data_short_MA <- data_short_MA[, !idx_time] "
"0",""
"0","data_short_MA <- data_short_MA %>% "
"0","  rename_with(~gsub('.', '', .x, fixed = TRUE)) %>% "
"0","  rename_with(toupper, .cols = -contains('subject'))"
"0",""
"0","n_sbj <- nrow( data_short_MA )"
