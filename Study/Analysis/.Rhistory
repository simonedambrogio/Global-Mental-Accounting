df_plot(mPlay, 5, "Play"),
df_plot(mPlane, 6, "Plane"),
df_plot(mPlane, 7, "Drink"),
df_plot(mPlane, 8, "Gym")
) %>%
ggplot(aes(x, beta, fill=var)) +
# geom_errorbar(aes(ymin=0.002, ymax=Q97.5), width=0.02) +
geom_bar(stat="identity") +
theme_pubr() +
scale_x_continuous(breaks = c(1.5, 3:6),
labels = c("MrAB", "Game", "Jacket", "Play", "Plane"))
rbind(
df_plot(mMrAB1, 1.2, "MrAB1"),
df_plot(mMrAB1, 1.8, "MrAB2"),
df_plot(mGame, 3, "Game"),
df_plot(mJacket, 4, "Jacket"),
df_plot(mPlay, 5, "Play"),
df_plot(mPlane, 6, "Plane"),
df_plot(mDrink, 7, "Drink"),
df_plot(mGym, 8, "Gym")
) %>%
ggplot(aes(x, beta, fill=var)) +
# geom_errorbar(aes(ymin=0.002, ymax=Q97.5), width=0.02) +
geom_bar(stat="identity") +
theme_pubr() +
scale_x_continuous(breaks = c(1.5, 3:8),
labels = c("MrAB", "Game", "Jacket", "Play",
"Plane", "Drink", "Gym"))
fe %>%
filter(stri_detect_fixed(var, ":")) %>%
mutate(var=sapply(str_split(var, ":"), function(x) x[2])) %>%
mutate(
x=seq(x-0.2, x+0.2, length=5),
study=study_name,
var=ifelse(var=="FinancialLiteracy", "Financial\nLiteracy",var),
var=ifelse(var=="GenderMale", "Gender",var),
var=ifelse(var=="numeric_income", "Income",var)
)
df_plot <- function(m, x, study_name){
fe <- fixef(m) %>% as.data.frame()
fe <- data.frame(beta=fe[,1], var=row.names(fe))
fe %>%
filter(stri_detect_fixed(var, ":")) %>%
mutate(var=sapply(str_split(var, ":"), function(x) x[2])) %>%
mutate(
x=seq(x-0.2, x+0.2, length=5),
study=study_name,
var=ifelse(var=="FinancialLiteracy", "Financial\nLiteracy",var),
var=ifelse(var=="GenderMale", "Gender",var),
var=ifelse(var=="numeric_income", "Income",var)
)
}
rbind(
df_plot(mMrAB1, 1.2, "MrAB1"),
df_plot(mMrAB1, 1.8, "MrAB2"),
df_plot(mGame, 3, "Game"),
df_plot(mJacket, 4, "Jacket"),
df_plot(mPlay, 5, "Play"),
df_plot(mPlane, 6, "Plane"),
df_plot(mDrink, 7, "Drink"),
df_plot(mGym, 8, "Gym")
) %>%
ggplot(aes(x, beta, fill=var)) +
# geom_errorbar(aes(ymin=0.002, ymax=Q97.5), width=0.02) +
geom_bar(stat="identity") +
theme_pubr() +
scale_x_continuous(breaks = c(1.5, 3:8),
labels = c("MrAB", "Game", "Jacket", "Play",
"Plane", "Drink", "Gym"))
rbind(
df_plot(mMrAB1, 1.2, "MrAB1"),
df_plot(mMrAB1, 1.8, "MrAB2"),
df_plot(mGame, 3, "Game"),
df_plot(mJacket, 4, "Jacket"),
df_plot(mPlay, 5, "Play"),
df_plot(mPlane, 6, "Plane"),
df_plot(mDrink, 7, "Drink"),
df_plot(mGym, 8, "Gym")
) %>%
ggplot(aes(x, beta, fill=var)) +
# geom_errorbar(aes(ymin=0.002, ymax=Q97.5), width=0.02) +
geom_bar(stat="identity") +
theme_pubr() +
scale_x_continuous(breaks = c(1.5, 3:8),
labels = c("MrAB", "Game", "Jacket", "Play",
"Plane", "Drink", "Gym")) +
labs(fill=NULL)
rbind(
df_plot(mMrAB1, 1.2, "MrAB1"),
df_plot(mMrAB1, 1.8, "MrAB2"),
df_plot(mGame, 3, "Game"),
df_plot(mJacket, 4, "Jacket"),
df_plot(mPlay, 5, "Play"),
df_plot(mPlane, 6, "Plane"),
df_plot(mDrink, 7, "Drink"),
df_plot(mGym, 8, "Gym")
) %>%
ggplot(aes(x, beta, fill=var)) +
# geom_errorbar(aes(ymin=0.002, ymax=Q97.5), width=0.02) +
geom_bar(stat="identity") +
theme_pubr() +
scale_x_continuous(breaks = c(1.5, 3:8),
labels = c("MrAB", "Game", "Jacket", "Play",
"Plane", "Drink", "Gym")) +
labs(fill=NULL, x=NULL, y="Interaction")
rbind(
df_plot(mMrAB1, 1.2, "MrAB1"),
df_plot(mMrAB1, 1.8, "MrAB2"),
df_plot(mGame, 3, "Game"),
df_plot(mJacket, 4, "Jacket"),
df_plot(mPlay, 5, "Play"),
df_plot(mPlane, 6, "Plane"),
df_plot(mDrink, 7, "Drink"),
df_plot(mGym, 8, "Gym")
) %>%
ggplot(aes(x, beta, fill=var)) +
# geom_errorbar(aes(ymin=0.002, ymax=Q97.5), width=0.02) +
geom_bar(stat="identity") +
theme_pubr() +
scale_x_continuous(breaks = c(1.5, 3:8),
labels = c("MrAB", "Game", "Jacket", "Play",
"Plane", "Drink", "Gym")) +
labs(fill=NULL, x=NULL, y="Interaction") +
theme(legend.position = c(0.8, 0.8))
rbind(
df_plot(mMrAB1, 1.2, "MrAB1"),
df_plot(mMrAB1, 1.8, "MrAB2"),
df_plot(mGame, 3, "Game"),
df_plot(mJacket, 4, "Jacket"),
df_plot(mPlay, 5, "Play"),
df_plot(mPlane, 6, "Plane"),
df_plot(mDrink, 7, "Drink"),
df_plot(mGym, 8, "Gym")
) %>%
ggplot(aes(x, beta, fill=var)) +
# geom_errorbar(aes(ymin=0.002, ymax=Q97.5), width=0.02) +
geom_bar(stat="identity") +
theme_pubr() +
scale_x_continuous(breaks = c(1.5, 3:8),
labels = c("MrAB", "Game", "Jacket", "Play",
"Plane", "Drink", "Gym")) +
labs(fill=NULL, x=NULL, y="Interaction") +
theme(legend.position = c(0.8, 0.9))
rbind(
df_plot(mMrAB1, 1.2, "MrAB1"),
df_plot(mMrAB1, 1.8, "MrAB2"),
df_plot(mGame, 3, "Game"),
df_plot(mJacket, 4, "Jacket"),
df_plot(mPlay, 5, "Play"),
df_plot(mPlane, 6, "Plane"),
df_plot(mDrink, 7, "Drink"),
df_plot(mGym, 8, "Gym")
) %>%
ggplot(aes(x, beta, fill=var)) +
# geom_errorbar(aes(ymin=0.002, ymax=Q97.5), width=0.02) +
geom_bar(stat="identity") +
theme_pubr() +
scale_x_continuous(breaks = c(1.5, 3:8),
labels = c("MrAB", "Game", "Jacket", "Play",
"Plane", "Drink", "Gym")) +
labs(fill=NULL, x=NULL, y="Interaction") +
theme(legend.position = c(0.85, 0.85))
rbind(
df_plot(mMrAB1, 1.2, "MrAB1"),
df_plot(mMrAB2, 1.8, "MrAB2"),
df_plot(mGame, 3, "Game"),
df_plot(mJacket, 4, "Jacket"),
df_plot(mPlay, 5, "Play"),
df_plot(mPlane, 6, "Plane"),
df_plot(mDrink, 7, "Drink"),
df_plot(mGym, 8, "Gym")
) %>%
ggplot(aes(x, beta, fill=var)) +
# geom_errorbar(aes(ymin=0.002, ymax=Q97.5), width=0.02) +
geom_bar(stat="identity") +
theme_pubr() +
scale_x_continuous(breaks = c(1.5, 3:8),
labels = c("MrAB", "Game", "Jacket", "Play",
"Plane", "Drink", "Gym")) +
labs(fill=NULL, x=NULL, y="Interaction") +
theme(legend.position = c(0.85, 0.85))
rbind(
df_plot(mMrAB1, 1.2, "MrAB1"),
df_plot(mMrAB2, 1.8, "MrAB2"),
df_plot(mGame, 3, "Game"),
df_plot(mJacket, 4, "Jacket"),
df_plot(mPlay, 5, "Play"),
df_plot(mPlane, 6, "Plane"),
df_plot(mDrink, 7, "Drink"),
df_plot(mGym, 8, "Gym")
) %>%
ggplot(aes(x, beta, fill=var)) +
# geom_errorbar(aes(ymin=0.002, ymax=Q97.5), width=0.02) +
geom_bar(stat="identity") +
geom_hline(yintercept = 0) +
theme_pubr() +
scale_x_continuous(breaks = c(1.5, 3:8),
labels = c("MrAB", "Game", "Jacket", "Play",
"Plane", "Drink", "Gym")) +
labs(fill=NULL, x=NULL, y="Interaction") +
theme(legend.position = c(0.85, 0.85))
rbind(
df_plot(mMrAB1, 1.2, "MrAB1"),
df_plot(mMrAB2, 1.8, "MrAB2"),
df_plot(mGame, 3, "Game"),
df_plot(mJacket, 4, "Jacket"),
df_plot(mPlay, 5, "Play"),
df_plot(mPlane, 6, "Plane"),
df_plot(mDrink, 7, "Drink"),
df_plot(mGym, 8, "Gym")
) %>%
ggplot(aes(x, beta, fill=var)) +
# geom_errorbar(aes(ymin=0.002, ymax=Q97.5), width=0.02) +
geom_bar(stat="identity") +
geom_hline(yintercept = 0, linewidth=0.5) +
theme_pubr() +
scale_x_continuous(breaks = c(1.5, 3:8),
labels = c("MrAB", "Game", "Jacket", "Play",
"Plane", "Drink", "Gym")) +
labs(fill=NULL, x=NULL, y="Interaction") +
theme(legend.position = c(0.85, 0.85))
rbind(
df_plot(mMrAB1, 1.2, "MrAB1"),
df_plot(mMrAB2, 1.8, "MrAB2"),
df_plot(mGame, 3, "Game"),
df_plot(mJacket, 4, "Jacket"),
df_plot(mPlay, 5, "Play"),
df_plot(mPlane, 6, "Plane"),
df_plot(mDrink, 7, "Drink"),
df_plot(mGym, 8, "Gym")
) %>%
ggplot(aes(x, beta, fill=var)) +
# geom_errorbar(aes(ymin=0.002, ymax=Q97.5), width=0.02) +
geom_bar(stat="identity") +
geom_hline(yintercept = 0, linewidth=0.2) +
theme_pubr() +
scale_x_continuous(breaks = c(1.5, 3:8),
labels = c("MrAB", "Game", "Jacket", "Play",
"Plane", "Drink", "Gym")) +
labs(fill=NULL, x=NULL, y="Interaction") +
theme(legend.position = c(0.85, 0.85))
summary(mMrAB1)
summary(mMrAB2)
summary(mGame)
summary(mDrink)
summary(mDrink)
summary(mJacket)
summary(mPlay)
summary(mPlane)
summary(mGym)
summary(mMrAB1)
df_plot(mMrAB1, 1.2, "MrAB1") %>%
mutate(is_sign=rep("no", 5))
summary(mMrAB2)
summary(mGame)
summary(mJacket)
summary(mPlay)
summary(mplane)
summary(mPlane)
summary(mDrink)
summary(mGym)
rbind(
df_plot(mMrAB1, 1.2, "MrAB1") %>%
mutate(is_sign=rep("no", 5)),
df_plot(mMrAB2, 1.8, "MrAB2") %>%
mutate(is_sign=c("no", "yes", "yes", "no", "yes")),
df_plot(mGame, 3, "Game") %>%
mutate(is_sign=c("yes", "no", "yes", "yes", "yes")),
df_plot(mJacket, 4, "Jacket") %>%
mutate(is_sign=c("no", "no", "no", "no", "no")),
df_plot(mPlay, 5, "Play") %>%
mutate(is_sign=c("no", "no", "yes", "no", "no")),
df_plot(mPlane, 6, "Plane") %>%
mutate(is_sign=c("no", "no", "no", "yes", "no")),
df_plot(mDrink, 7, "Drink") %>%
mutate(is_sign=c("yes", "no", "no", "no", "no")),
df_plot(mGym, 8, "Gym") %>%
mutate(is_sign=c("yes", "no", "yes", "no", "no"))
) %>%
ggplot(aes(x, beta, fill=var, alpha=is_sign)) +
# geom_errorbar(aes(ymin=0.002, ymax=Q97.5), width=0.02) +
geom_bar(stat="identity") +
geom_hline(yintercept = 0, linewidth=0.2) +
theme_pubr() +
scale_x_continuous(breaks = c(1.5, 3:8),
labels = c("MrAB", "Game", "Jacket", "Play",
"Plane", "Drink", "Gym")) +
labs(fill=NULL, x=NULL, y="Interaction") +
theme(legend.position = c(0.85, 0.85))
rbind(
df_plot(mMrAB1, 1.2, "MrAB1") %>%
mutate(is_sign=rep("no", 5)),
df_plot(mMrAB2, 1.8, "MrAB2") %>%
mutate(is_sign=c("no", "yes", "yes", "no", "yes")),
df_plot(mGame, 3, "Game") %>%
mutate(is_sign=c("yes", "no", "yes", "yes", "yes")),
df_plot(mJacket, 4, "Jacket") %>%
mutate(is_sign=c("no", "no", "no", "no", "no")),
df_plot(mPlay, 5, "Play") %>%
mutate(is_sign=c("no", "no", "yes", "no", "no")),
df_plot(mPlane, 6, "Plane") %>%
mutate(is_sign=c("no", "no", "no", "yes", "no")),
df_plot(mDrink, 7, "Drink") %>%
mutate(is_sign=c("yes", "no", "no", "no", "no")),
df_plot(mGym, 8, "Gym") %>%
mutate(is_sign=c("yes", "no", "yes", "no", "no"))
) %>%
ggplot(aes(x, beta, fill=var, color=var, alpha=is_sign)) +
# geom_errorbar(aes(ymin=0.002, ymax=Q97.5), width=0.02) +
geom_bar(stat="identity") +
geom_hline(yintercept = 0, linewidth=0.2) +
theme_pubr() +
scale_x_continuous(breaks = c(1.5, 3:8),
labels = c("MrAB", "Game", "Jacket", "Play",
"Plane", "Drink", "Gym")) +
labs(fill=NULL, x=NULL, y="Interaction") +
theme(legend.position = c(0.85, 0.85))
rbind(
df_plot(mMrAB1, 1.2, "MrAB1") %>%
mutate(is_sign=rep("no", 5)),
df_plot(mMrAB2, 1.8, "MrAB2") %>%
mutate(is_sign=c("no", "yes", "yes", "no", "yes")),
df_plot(mGame, 3, "Game") %>%
mutate(is_sign=c("yes", "no", "yes", "yes", "yes")),
df_plot(mJacket, 4, "Jacket") %>%
mutate(is_sign=c("no", "no", "no", "no", "no")),
df_plot(mPlay, 5, "Play") %>%
mutate(is_sign=c("no", "no", "yes", "no", "no")),
df_plot(mPlane, 6, "Plane") %>%
mutate(is_sign=c("no", "no", "no", "yes", "no")),
df_plot(mDrink, 7, "Drink") %>%
mutate(is_sign=c("yes", "no", "no", "no", "no")),
df_plot(mGym, 8, "Gym") %>%
mutate(is_sign=c("yes", "no", "yes", "no", "no"))
) %>%
ggplot(aes(x, beta, fill=var, color=var, alpha=is_sign)) +
# geom_errorbar(aes(ymin=0.002, ymax=Q97.5), width=0.02) +
geom_bar(stat="identity") +
geom_hline(yintercept = 0, linewidth=0.2) +
theme_pubr() +
scale_x_continuous(breaks = c(1.5, 3:8),
labels = c("MrAB", "Game", "Jacket", "Play",
"Plane", "Drink", "Gym")) +
labs(fill=NULL, x=NULL, y="Interaction") +
theme(legend.position = c(0.85, 0.85)) +
guides(color="none", alpha="none")
summary(mDrink)
summary(mGame)
summary(mGym)
summary(mMrAB1)
summary(mMrAB2)
summary(mJacket)
summary(mPlay)
summary(mPlane)
summary(mMrAB1)
summary(mMrAB2)
summary(mGame)
summary(mJacket)
summary(mPlay)
summary(mPlane)
summary(mDrink)
summary(mDrink)
summary(mDrink)
summary(mGym)
summary(mGame)
summary(mPlay)
summary(mGym)
summary(mMrAB1)
summary(mMrAB2)
summary(mJacket)
summary(mPlane)
summary(mDrink)
summary(mGame)
summary(mPlane)
summary(mMrAB1)
summary(mMrAB2)
summary(mJacket)
summary(mPlay)
summary(mDrink)
summary(mGym)
summary(mGame)
summary(mMrAB1)
summary(mMrAB2)
summary(mGame)
summary(mJacket)
summary(mPlay)
summary(mPlane)
summary(mDrink)
summary(mGym)
rbind(
df_plot(mMrAB1, 1.2, "MrAB1") %>%
mutate(is_sign=rep("no", 5)),
df_plot(mMrAB2, 1.8, "MrAB2") %>%
mutate(is_sign=c("no", "yes", "yes", "no", "yes")),
df_plot(mGame, 3, "Game") %>%
mutate(is_sign=c("yes", "no", "yes", "yes", "yes")),
df_plot(mJacket, 4, "Jacket") %>%
mutate(is_sign=c("no", "no", "no", "no", "no")),
df_plot(mPlay, 5, "Play") %>%
mutate(is_sign=c("no", "no", "yes", "no", "no")),
df_plot(mPlane, 6, "Plane") %>%
mutate(is_sign=c("no", "no", "no", "yes", "no")),
df_plot(mDrink, 7, "Drink") %>%
mutate(is_sign=c("yes", "no", "no", "no", "no")),
df_plot(mGym, 8, "Gym") %>%
mutate(is_sign=c("yes", "no", "yes", "no", "no"))
) %>%
ggplot(aes(x, beta, fill=var, color=var, alpha=is_sign)) +
# geom_errorbar(aes(ymin=0.002, ymax=Q97.5), width=0.02) +
geom_bar(stat="identity") +
geom_hline(yintercept = 0, linewidth=0.2) +
theme_pubr() +
scale_x_continuous(breaks = c(1.5, 3:8),
labels = c("MrAB", "Game", "Jacket", "Play",
"Plane", "Drink", "Gym"),
guide = "prism_offset") +
scale_y_continuous(guide = "prism_offset") +
labs(fill=NULL, x=NULL, y="Interaction") +
theme(legend.position = c(0.85, 0.85)) +
guides(color="none", alpha="none")
rbind(
df_plot(mMrAB1, 1.2, "MrAB1") %>%
mutate(is_sign=rep("no", 5)),
df_plot(mMrAB2, 1.8, "MrAB2") %>%
mutate(is_sign=c("no", "yes", "yes", "no", "yes")),
df_plot(mGame, 3, "Game") %>%
mutate(is_sign=c("yes", "no", "yes", "yes", "yes")),
df_plot(mJacket, 4, "Jacket") %>%
mutate(is_sign=c("no", "no", "no", "no", "no")),
df_plot(mPlay, 5, "Play") %>%
mutate(is_sign=c("no", "no", "yes", "no", "no")),
df_plot(mPlane, 6, "Plane") %>%
mutate(is_sign=c("no", "no", "no", "yes", "no")),
df_plot(mDrink, 7, "Drink") %>%
mutate(is_sign=c("yes", "no", "no", "no", "no")),
df_plot(mGym, 8, "Gym") %>%
mutate(is_sign=c("yes", "no", "yes", "no", "no"))
) %>%
ggplot(aes(x, beta, fill=var, color=var, alpha=is_sign)) +
# geom_errorbar(aes(ymin=0.002, ymax=Q97.5), width=0.02) +
geom_bar(stat="identity") +
geom_hline(yintercept = 0, linewidth=0.2) +
theme_pubr() +
scale_x_continuous(breaks = c(1.5, 3:8),
labels = c("MrAB", "Game", "Jacket", "Play",
"Plane", "Drink", "Gym"),
guide = "prism_offset") +
scale_y_continuous(guide = "prism_offset") +
labs(fill=NULL, x=NULL, y="Interaction") +
theme(legend.position = c(0.85, 0.85),
text = element_text(size = 15)) +
guides(color="none", alpha="none")
rbind(
df_plot(mMrAB1, 1.2, "MrAB1") %>%
mutate(is_sign=rep("no", 5)),
df_plot(mMrAB2, 1.8, "MrAB2") %>%
mutate(is_sign=c("no", "yes", "yes", "no", "yes")),
df_plot(mGame, 3, "Game") %>%
mutate(is_sign=c("yes", "no", "yes", "yes", "yes")),
df_plot(mJacket, 4, "Jacket") %>%
mutate(is_sign=c("no", "no", "no", "no", "no")),
df_plot(mPlay, 5, "Play") %>%
mutate(is_sign=c("no", "no", "yes", "no", "no")),
df_plot(mPlane, 6, "Plane") %>%
mutate(is_sign=c("no", "no", "no", "yes", "no")),
df_plot(mDrink, 7, "Drink") %>%
mutate(is_sign=c("yes", "no", "no", "no", "no")),
df_plot(mGym, 8, "Gym") %>%
mutate(is_sign=c("yes", "no", "yes", "no", "no"))
) %>%
ggplot(aes(x, beta, fill=var, color=var, alpha=is_sign)) +
# geom_errorbar(aes(ymin=0.002, ymax=Q97.5), width=0.02) +
geom_bar(stat="identity") +
geom_hline(yintercept = 0, linewidth=0.2) +
theme_pubr() +
scale_x_continuous(breaks = c(1.5, 3:8),
labels = c("MrAB", "Game", "Jacket", "Play",
"Plane", "Drink", "Gym"),
guide = "prism_offset") +
scale_y_continuous(guide = "prism_offset") +
labs(fill=NULL, x=NULL, y=expression(beta)) +
theme(legend.position = c(0.85, 0.85),
text = element_text(size = 15)) +
guides(color="none", alpha="none")
setwd("/Volumes/KINGSTON/Simone/Study/Analysis")
setwd("/Volumes/PROJECTS/Ongoing/MMAR/MMAR GitHub/Study/Analysis")
# Load libraries
library(dplyr); library(purrr); library(stringr)
library(ggplot2); library(ggpubr); library(jcolors)
library(cowplot); library(ggprism); library(tidybayes)
library(reshape2); library(parallel); library(rstan)
library(brms); library(plotly); library(knitr);
library(kableExtra); library(tidyverse)
lazyLoad("index_cache/html/Code-to-load-data-and-libraries_ac2dcc77804d4e19a61ad58c57f9e0c7")
mMrAB2 <- brm(response ~ condition*(Age+Education+FinancialLiteracy+Gender+numeric_income) + (condition+FinancialLiteracy+Age+Education+FinancialLiteracy+Gender+numeric_income | Country),
data = MrAB %>%
# Tidy
mutate(Age=as.numeric(Age)) %>%
filter(Age>0 & Age<99) %>%
mutate(Education=as.numeric(Education)) %>%
filter(Education<100) %>%
filter(Gender%in%c("Male", "Female")) %>%
mutate(condition_group=ifelse(
condition %in% c("gain-gain VS gain", "gain-loss VS gain"),
"gain",
"loss"
)) %>%
filter(condition_group=="loss") %>%
mutate(condition=factor(condition, levels = c("loss-gain VS loss", "loss-loss VS loss") )),
iter = 20000, refresh = 1, cores = 2, chains = 2,
family="bernoulli")
saveRDS(mMrAB2, file = "index_cache/brms_exploratory/mMrAB2.rds")
