table.attr = "style='width:40%;'", booktabs = T) %>%
kable_classic(html_font = "Cambria") %>%
# kable_material(c("striped", "hover")) %>%
row_spec(0, bold = TRUE)
data_table %>%
flextable() %>%
set_caption(caption = "Table 1: Demographics") %>%
theme_apa() %>%
width(width=c(1,1,0.5,0.8,1.2)) %>%
padding(padding.top = 0, padding.bottom = 0, part = "all") %>%
align(align='left') %>%
align(align='left', part='header') %>%
save_as_docx(path = "tables/docx/Demographics.docx")
data_table %>%
flextable() %>%
set_caption(caption = "Table 1: Demographics") %>%
theme_apa() %>%
width(width=c(1,1,0.5,0.8,1.2)) %>%
padding(padding.top = 0, padding.bottom = 0, part = "all") %>%
align(align='left') %>%
align(align='left', part='header')
lazyLoad("index_cache/html/table-preregistered_20268cf722c097b225d5e09b1bf8d536")
table_bayesian[,c(4,1:3)] %>%
select(-Study) %>%
flextable() %>%
set_caption(caption = "Table 2: Hierarchical Bayesian Meta-Analysis") %>%
theme_apa() %>%
padding(padding.top = 0, padding.bottom = 0, part = "all") %>%
align(align='left') %>%
align(align='left', part='header') %>%
autofit()
MrAB <- read.csv("../Data/Preregistered/MrAB.csv")
MrAB
lazyLoad("index_cache/html/fit-exploratory-Plane_2f20bf143b0f934dd0469fab1a08198c")
# --------- Fit Exploratory ------------- #
lazyLoad("index_cache/html/fit-exploratory-MrAB1_42ce1c34eb34f7ae6bfd5c14b3c59062")
summary(mMrAB1)
mMrAB1 <- readRDS("index_cache/brms_exploratory/mMrAB1.rds")
mMrAB2 <- readRDS("index_cache/brms_exploratory/mMrAB2.rds")
mGame <- readRDS("index_cache/brms_exploratory/mGame.rds")
mDrink <- readRDS("index_cache/brms_exploratory/mDrink.rds")
mJacket <- readRDS("index_cache/brms_exploratory/mJacket.rds")
mPlay <- readRDS("index_cache/brms_exploratory/mPlay.rds")
mGym <- readRDS("index_cache/brms_exploratory/mGym.rds")
mPlane <- readRDS("index_cache/brms_exploratory/mPlane.rds")
summary(mMrAB1)
# --------- Fit Exploratory ------------- #
lazyLoad("index_cache/html/fit-exploratory-MrAB1_42ce1c34eb34f7ae6bfd5c14b3c59062")
lazyLoad("index_cache/html/fit-exploratory-MrAB2_bcad070ed4ced86a27180d8bf0b81443")
lazyLoad("index_cache/html/fit-exploratory-Game_bc35536c9e4cdd60d9ba27bd9431c1b3")
lazyLoad("index_cache/html/fit-exploratory-Drink_cd4cfd16f5ee20061da6082805aa1027")
lazyLoad("index_cache/html/fit-exploratory-Jacket_a3db8e695fd35ca1b62b16e2a8080354")
lazyLoad("index_cache/html/fit-exploratory-Play_bf57d38fb040e05d0551d18e9039eaf5")
lazyLoad("index_cache/html/fit-exploratory-Gym_3b0b26e020bc0cc530c51a585df3e403")
lazyLoad("index_cache/html/fit-exploratory-Plane_2f20bf143b0f934dd0469fab1a08198c")
mMrAB1 <- readRDS("index_cache/brms_exploratory/mMrAB1.rds")
mMrAB2 <- readRDS("index_cache/brms_exploratory/mMrAB2.rds")
mGame <- readRDS("index_cache/brms_exploratory/mGame.rds")
mDrink <- readRDS("index_cache/brms_exploratory/mDrink.rds")
mJacket <- readRDS("index_cache/brms_exploratory/mJacket.rds")
mPlay <- readRDS("index_cache/brms_exploratory/mPlay.rds")
mGym <- readRDS("index_cache/brms_exploratory/mGym.rds")
mPlane <- readRDS("index_cache/brms_exploratory/mPlane.rds")
library(stringi)
df_plot <- function(m, x, study_name){
fe <- fixef(m) %>% as.data.frame()
fe <- data.frame(beta=fe[,1], lower=fe[,3], upper=fe[,4], var=row.names(fe))
fe %>%
filter(stri_detect_fixed(var, ":")) %>%
mutate(var=sapply(str_split(var, ":"), function(x) x[2])) %>%
mutate(
x=seq(x-0.2, x+0.2, length=5),
study=study_name,
var=ifelse(var=="FinancialLiteracy", "Financial\nLiteracy",var),
var=ifelse(var=="GenderMale", "Gender",var),
var=ifelse(var=="numeric_income", "Income",var)
) %>%
mutate(is_sign=ifelse(sign(lower)==sign(upper),"yes", "no"))
}
df <- rbind(
df_plot(mMrAB1, 1.2, "MrAB1"),
df_plot(mMrAB2, 1.8, "MrAB2"),
df_plot(mGame, 3, "Game"),
df_plot(mJacket, 4, "Jacket"),
df_plot(mPlay, 5, "Play"),
df_plot(mPlane, 6, "Plane"),
df_plot(mDrink, 7, "Drink"),
df_plot(mGym, 8, "Gym")
)
# Load libraries
library(dplyr); library(purrr); library(stringr)
library(ggplot2); library(ggpubr); library(jcolors)
library(cowplot); library(ggprism); library(tidybayes)
library(reshape2); library(parallel); library(rstan)
library(brms)
library(plotly)
color_21countries <- c(
"#440154FF", "#481467FF", "#482576FF", "#463480FF",
"#414487FF", "#3B528BFF", "#35608DFF", "#2F6C8EFF",
"#2A788EFF", "#25848EFF", "#21908CFF", "#1E9C89FF",
"#22A884FF", "#2FB47CFF", "#43BF71FF", "#5DC863FF",
"#7AD151FF", "#9AD93CFF", "#BBDF27FF", "#DEE318FF",
"#FDE725FF"
)
df <- rbind(
df_plot(mMrAB1, 1.2, "MrAB1"),
df_plot(mMrAB2, 1.8, "MrAB2"),
df_plot(mGame, 3, "Game"),
df_plot(mJacket, 4, "Jacket"),
df_plot(mPlay, 5, "Play"),
df_plot(mPlane, 6, "Plane"),
df_plot(mDrink, 7, "Drink"),
df_plot(mGym, 8, "Gym")
)
df %>% filter(var=="Financial\nLiteracy")
df %>%
ggplot(aes(x, beta, fill=var, color=var, shape=is_sign, linetype=is_sign)) +
geom_hline(yintercept = 0, linewidth=0.2) +
geom_segment(aes(x = x, xend=x, y=lower, yend=upper)) +
geom_point(stat="identity", size=3) +
theme_pubr() +
scale_x_continuous(breaks = c(1.5, 3:8),
labels = c("MrAB", "Game", "Jacket", "Play",
"Plane", "Drink", "Gym"),
guide = "prism_offset") +
scale_y_continuous(guide = "prism_offset") +
labs(fill=NULL, x=NULL, y=expression(beta), color=NULL) +
theme(legend.position = c(0.9, 0.25),
text = element_text(size = 15)) +
guides(fill="none", alpha="none") +
facet_wrap(~var, scale="free")
df %>%
mutate(study=ifelse( (study=="MrAB1" | study=="MrAB2"), "MrAB", study)) %>%
# Age
mutate(beta=ifelse(var=="Age", beta*sd(data$Age), beta)) %>%
mutate(lower=ifelse(var=="Age", lower*sd(data$Age), lower)) %>%
mutate(upper=ifelse(var=="Age", upper*sd(data$Age), upper)) %>%
# Education
mutate(beta=ifelse(var=="Education", beta*sd(data$Education), beta)) %>%
mutate(lower=ifelse(var=="Education", lower*sd(data$Education), lower)) %>%
mutate(upper=ifelse(var=="Education", upper*sd(data$Education), upper)) %>%
# Financial Literacy
mutate(beta=ifelse(var=="Financial\nLiteracy", beta*sd(data$FinancialLiteracy), beta)) %>%
mutate(lower=ifelse(var=="Financial\nLiteracy", lower*sd(data$FinancialLiteracy), lower)) %>%
mutate(upper=ifelse(var=="Financial\nLiteracy", upper*sd(data$FinancialLiteracy), upper)) %>%
# Income
mutate(beta=ifelse(var=="Income", beta*sd(data$numeric_income, na.rm=T), beta)) %>%
mutate(lower=ifelse(var=="Income", lower*sd(data$numeric_income, na.rm=T), lower)) %>%
mutate(upper=ifelse(var=="Income", upper*sd(data$numeric_income, na.rm=T), upper)) %>%
mutate(x = x+rep(c(0.2, 0.1, 0, -0.1, -0.2), 8)) %>%
mutate(study=factor(study, labels = c("MrAB", "Game", "Jacket", "Play", "Plane", "Drink", "Gym"),
levels = c("MrAB", "Game", "Jacket", "Play", "Plane", "Drink", "Gym"),
)) %>%
ggplot(aes(x, beta, fill=var, color=study, shape=is_sign, linetype=is_sign)) +
geom_hline(yintercept = 0, linewidth=0.2) +
geom_segment(aes(x = x, xend=x, y=lower, yend=upper)) +
geom_point(stat="identity", size=3) +
theme_cowplot() +
scale_x_continuous(breaks = c(1.5, 3:8),
labels = c("MrAB", "Game", "Jacket", "Play",
"Plane", "Drink", "Gym"),
guide = "prism_offset") +
scale_y_continuous(guide = "prism_offset") +
labs(fill=NULL, x=NULL, y=expression(Standardized~beta), color="Study") +
theme(legend.position = c(0.85, 0.25),
text = element_text(size = 15),
# strip.background = element_rect(fill="#E2E2E2"),
strip.background = element_rect(fill="#F9F9F9"),
# axis.ticks.x = element_blank(),
axis.text.x = element_blank()) +
guides(fill="none", alpha="none", shape="none", linetype="none") +
facet_wrap(~var) +
scale_color_manual(values = qualitative_hcl(7, "Dark 3")[c(5, 2, 4, 7, 6, 1, 3)])
df %>%
mutate(study=ifelse( (study=="MrAB1" | study=="MrAB2"), "MrAB", study))
df %>%
mutate(study=ifelse( (study=="MrAB1" | study=="MrAB2"), "MrAB", study)) %>%
# Age
mutate(beta=ifelse(var=="Age", beta*sd(data$Age), beta))
data = MrAB %>%
# Tidy
mutate(Age=as.numeric(Age)) %>%
filter(Age>0 & Age<99) %>%
mutate(Education=as.numeric(Education)) %>%
filter(Education<100) %>%
filter(Gender%in%c("Male", "Female")) %>%
mutate(condition_group=ifelse(
condition %in% c("gain-gain VS gain", "gain-loss VS gain"),
"gain",
"loss"
)) %>%
filter(condition_group=="gain") %>%
mutate(condition=factor(condition, levels = c("gain-loss VS gain", "gain-gain VS gain") )) %>%
group_by(subject) %>% filter(row_number()==1) %>% ungroup()
MrAB <- read.csv("../Data/Preregistered/MrAB.csv")
data = MrAB %>%
# Tidy
mutate(Age=as.numeric(Age)) %>%
filter(Age>0 & Age<99) %>%
mutate(Education=as.numeric(Education)) %>%
filter(Education<100) %>%
filter(Gender%in%c("Male", "Female")) %>%
mutate(condition_group=ifelse(
condition %in% c("gain-gain VS gain", "gain-loss VS gain"),
"gain",
"loss"
)) %>%
filter(condition_group=="gain") %>%
mutate(condition=factor(condition, levels = c("gain-loss VS gain", "gain-gain VS gain") )) %>%
group_by(subject) %>% filter(row_number()==1) %>% ungroup()
data
df %>%
mutate(study=ifelse( (study=="MrAB1" | study=="MrAB2"), "MrAB", study)) %>%
# Age
mutate(beta=ifelse(var=="Age", beta*sd(data$Age), beta)) %>%
mutate(lower=ifelse(var=="Age", lower*sd(data$Age), lower)) %>%
mutate(upper=ifelse(var=="Age", upper*sd(data$Age), upper)) %>%
# Education
mutate(beta=ifelse(var=="Education", beta*sd(data$Education), beta)) %>%
mutate(lower=ifelse(var=="Education", lower*sd(data$Education), lower)) %>%
mutate(upper=ifelse(var=="Education", upper*sd(data$Education), upper)) %>%
# Financial Literacy
mutate(beta=ifelse(var=="Financial\nLiteracy", beta*sd(data$FinancialLiteracy), beta)) %>%
mutate(lower=ifelse(var=="Financial\nLiteracy", lower*sd(data$FinancialLiteracy), lower)) %>%
mutate(upper=ifelse(var=="Financial\nLiteracy", upper*sd(data$FinancialLiteracy), upper)) %>%
# Income
mutate(beta=ifelse(var=="Income", beta*sd(data$numeric_income, na.rm=T), beta)) %>%
mutate(lower=ifelse(var=="Income", lower*sd(data$numeric_income, na.rm=T), lower)) %>%
mutate(upper=ifelse(var=="Income", upper*sd(data$numeric_income, na.rm=T), upper)) %>%
mutate(x = x+rep(c(0.2, 0.1, 0, -0.1, -0.2), 8)) %>%
mutate(study=factor(study, labels = c("MrAB", "Game", "Jacket", "Play", "Plane", "Drink", "Gym"),
levels = c("MrAB", "Game", "Jacket", "Play", "Plane", "Drink", "Gym"),
)) %>%
ggplot(aes(x, beta, fill=var, color=study, shape=is_sign, linetype=is_sign)) +
geom_hline(yintercept = 0, linewidth=0.2) +
geom_segment(aes(x = x, xend=x, y=lower, yend=upper)) +
geom_point(stat="identity", size=3) +
theme_cowplot() +
scale_x_continuous(breaks = c(1.5, 3:8),
labels = c("MrAB", "Game", "Jacket", "Play",
"Plane", "Drink", "Gym"),
guide = "prism_offset") +
scale_y_continuous(guide = "prism_offset") +
labs(fill=NULL, x=NULL, y=expression(Standardized~beta), color="Study") +
theme(legend.position = c(0.85, 0.25),
text = element_text(size = 15),
# strip.background = element_rect(fill="#E2E2E2"),
strip.background = element_rect(fill="#F9F9F9"),
# axis.ticks.x = element_blank(),
axis.text.x = element_blank()) +
guides(fill="none", alpha="none", shape="none", linetype="none") +
facet_wrap(~var) +
scale_color_manual(values = qualitative_hcl(7, "Dark 3")[c(5, 2, 4, 7, 6, 1, 3)])
??qualitative_hcl
df %>%
mutate(study=ifelse( (study=="MrAB1" | study=="MrAB2"), "MrAB", study)) %>%
# Age
mutate(beta=ifelse(var=="Age", beta*sd(data$Age), beta)) %>%
mutate(lower=ifelse(var=="Age", lower*sd(data$Age), lower)) %>%
mutate(upper=ifelse(var=="Age", upper*sd(data$Age), upper)) %>%
# Education
mutate(beta=ifelse(var=="Education", beta*sd(data$Education), beta)) %>%
mutate(lower=ifelse(var=="Education", lower*sd(data$Education), lower)) %>%
mutate(upper=ifelse(var=="Education", upper*sd(data$Education), upper)) %>%
# Financial Literacy
mutate(beta=ifelse(var=="Financial\nLiteracy", beta*sd(data$FinancialLiteracy), beta)) %>%
mutate(lower=ifelse(var=="Financial\nLiteracy", lower*sd(data$FinancialLiteracy), lower)) %>%
mutate(upper=ifelse(var=="Financial\nLiteracy", upper*sd(data$FinancialLiteracy), upper)) %>%
# Income
mutate(beta=ifelse(var=="Income", beta*sd(data$numeric_income, na.rm=T), beta)) %>%
mutate(lower=ifelse(var=="Income", lower*sd(data$numeric_income, na.rm=T), lower)) %>%
mutate(upper=ifelse(var=="Income", upper*sd(data$numeric_income, na.rm=T), upper)) %>%
mutate(x = x+rep(c(0.2, 0.1, 0, -0.1, -0.2), 8)) %>%
mutate(study=factor(study, labels = c("MrAB", "Game", "Jacket", "Play", "Plane", "Drink", "Gym"),
levels = c("MrAB", "Game", "Jacket", "Play", "Plane", "Drink", "Gym"),
)) %>%
ggplot(aes(x, beta, fill=var, color=study, shape=is_sign, linetype=is_sign)) +
geom_hline(yintercept = 0, linewidth=0.2) +
geom_segment(aes(x = x, xend=x, y=lower, yend=upper)) +
geom_point(stat="identity", size=3) +
theme_cowplot() +
scale_x_continuous(breaks = c(1.5, 3:8),
labels = c("MrAB", "Game", "Jacket", "Play",
"Plane", "Drink", "Gym"),
guide = "prism_offset") +
scale_y_continuous(guide = "prism_offset") +
labs(fill=NULL, x=NULL, y=expression(Standardized~beta), color="Study") +
theme(legend.position = c(0.85, 0.25),
text = element_text(size = 15),
# strip.background = element_rect(fill="#E2E2E2"),
strip.background = element_rect(fill="#F9F9F9"),
# axis.ticks.x = element_blank(),
axis.text.x = element_blank()) +
guides(fill="none", alpha="none", shape="none", linetype="none") +
facet_wrap(~var) +
scale_color_manual(values = colorspaces::qualitative_hcl(7, "Dark 3")[c(5, 2, 4, 7, 6, 1, 3)])
colorspace
colorspace::qualitative_hcl
df %>%
mutate(study=ifelse( (study=="MrAB1" | study=="MrAB2"), "MrAB", study)) %>%
# Age
mutate(beta=ifelse(var=="Age", beta*sd(data$Age), beta)) %>%
mutate(lower=ifelse(var=="Age", lower*sd(data$Age), lower)) %>%
mutate(upper=ifelse(var=="Age", upper*sd(data$Age), upper)) %>%
# Education
mutate(beta=ifelse(var=="Education", beta*sd(data$Education), beta)) %>%
mutate(lower=ifelse(var=="Education", lower*sd(data$Education), lower)) %>%
mutate(upper=ifelse(var=="Education", upper*sd(data$Education), upper)) %>%
# Financial Literacy
mutate(beta=ifelse(var=="Financial\nLiteracy", beta*sd(data$FinancialLiteracy), beta)) %>%
mutate(lower=ifelse(var=="Financial\nLiteracy", lower*sd(data$FinancialLiteracy), lower)) %>%
mutate(upper=ifelse(var=="Financial\nLiteracy", upper*sd(data$FinancialLiteracy), upper)) %>%
# Income
mutate(beta=ifelse(var=="Income", beta*sd(data$numeric_income, na.rm=T), beta)) %>%
mutate(lower=ifelse(var=="Income", lower*sd(data$numeric_income, na.rm=T), lower)) %>%
mutate(upper=ifelse(var=="Income", upper*sd(data$numeric_income, na.rm=T), upper)) %>%
mutate(x = x+rep(c(0.2, 0.1, 0, -0.1, -0.2), 8)) %>%
mutate(study=factor(study, labels = c("MrAB", "Game", "Jacket", "Play", "Plane", "Drink", "Gym"),
levels = c("MrAB", "Game", "Jacket", "Play", "Plane", "Drink", "Gym"),
)) %>%
ggplot(aes(x, beta, fill=var, color=study, shape=is_sign, linetype=is_sign)) +
geom_hline(yintercept = 0, linewidth=0.2) +
geom_segment(aes(x = x, xend=x, y=lower, yend=upper)) +
geom_point(stat="identity", size=3) +
theme_cowplot() +
scale_x_continuous(breaks = c(1.5, 3:8),
labels = c("MrAB", "Game", "Jacket", "Play",
"Plane", "Drink", "Gym"),
guide = "prism_offset") +
scale_y_continuous(guide = "prism_offset") +
labs(fill=NULL, x=NULL, y=expression(Standardized~beta), color="Study") +
theme(legend.position = c(0.85, 0.25),
text = element_text(size = 15),
# strip.background = element_rect(fill="#E2E2E2"),
strip.background = element_rect(fill="#F9F9F9"),
# axis.ticks.x = element_blank(),
axis.text.x = element_blank()) +
guides(fill="none", alpha="none", shape="none", linetype="none") +
facet_wrap(~var) +
scale_color_manual(values = colorspace::qualitative_hcl(7, "Dark 3")[c(5, 2, 4, 7, 6, 1, 3)])
df
df %>%
mutate(is_sign=factor(is_sign, levels=c("yes", "no"))) %>%
mutate(study=ifelse( (study=="MrAB1" | study=="MrAB2"), "MrAB", study)) %>%
# Age
mutate(beta=ifelse(var=="Age", beta*sd(data$Age), beta)) %>%
mutate(lower=ifelse(var=="Age", lower*sd(data$Age), lower)) %>%
mutate(upper=ifelse(var=="Age", upper*sd(data$Age), upper)) %>%
# Education
mutate(beta=ifelse(var=="Education", beta*sd(data$Education), beta)) %>%
mutate(lower=ifelse(var=="Education", lower*sd(data$Education), lower)) %>%
mutate(upper=ifelse(var=="Education", upper*sd(data$Education), upper)) %>%
# Financial Literacy
mutate(beta=ifelse(var=="Financial\nLiteracy", beta*sd(data$FinancialLiteracy), beta)) %>%
mutate(lower=ifelse(var=="Financial\nLiteracy", lower*sd(data$FinancialLiteracy), lower)) %>%
mutate(upper=ifelse(var=="Financial\nLiteracy", upper*sd(data$FinancialLiteracy), upper)) %>%
# Income
mutate(beta=ifelse(var=="Income", beta*sd(data$numeric_income, na.rm=T), beta)) %>%
mutate(lower=ifelse(var=="Income", lower*sd(data$numeric_income, na.rm=T), lower)) %>%
mutate(upper=ifelse(var=="Income", upper*sd(data$numeric_income, na.rm=T), upper)) %>%
mutate(x = x+rep(c(0.2, 0.1, 0, -0.1, -0.2), 8)) %>%
mutate(study=factor(study, labels = c("MrAB", "Game", "Jacket", "Play", "Plane", "Drink", "Gym"),
levels = c("MrAB", "Game", "Jacket", "Play", "Plane", "Drink", "Gym"),
)) %>%
ggplot(aes(x, beta, fill=var, color=study, shape=is_sign, linetype=is_sign)) +
geom_hline(yintercept = 0, linewidth=0.2) +
geom_segment(aes(x = x, xend=x, y=lower, yend=upper)) +
geom_point(stat="identity", size=3) +
theme_cowplot() +
scale_x_continuous(breaks = c(1.5, 3:8),
labels = c("MrAB", "Game", "Jacket", "Play",
"Plane", "Drink", "Gym"),
guide = "prism_offset") +
scale_y_continuous(guide = "prism_offset") +
labs(fill=NULL, x=NULL, y=expression(Standardized~beta), color="Study") +
theme(legend.position = c(0.85, 0.25),
text = element_text(size = 15),
# strip.background = element_rect(fill="#E2E2E2"),
strip.background = element_rect(fill="#F9F9F9"),
# axis.ticks.x = element_blank(),
axis.text.x = element_blank()) +
guides(fill="none", alpha="none", shape="none", linetype="none") +
facet_wrap(~var) +
scale_color_manual(values = colorspace::qualitative_hcl(7, "Dark 3")[c(5, 2, 4, 7, 6, 1, 3)])
ggsave("./index_files/figure-html/exploratory.svg", device = "svg", width = 8, height = 4.5)
df %>%
mutate(is_sign=factor(is_sign, levels=c("yes", "no"))) %>%
mutate(study=ifelse( (study=="MrAB1" | study=="MrAB2"), "MrAB", study)) %>%
# Age
mutate(beta=ifelse(var=="Age", beta*sd(data$Age), beta)) %>%
mutate(lower=ifelse(var=="Age", lower*sd(data$Age), lower)) %>%
mutate(upper=ifelse(var=="Age", upper*sd(data$Age), upper)) %>%
# Education
mutate(beta=ifelse(var=="Education", beta*sd(data$Education), beta)) %>%
mutate(lower=ifelse(var=="Education", lower*sd(data$Education), lower)) %>%
mutate(upper=ifelse(var=="Education", upper*sd(data$Education), upper)) %>%
# Financial Literacy
mutate(beta=ifelse(var=="Financial\nLiteracy", beta*sd(data$FinancialLiteracy), beta)) %>%
mutate(lower=ifelse(var=="Financial\nLiteracy", lower*sd(data$FinancialLiteracy), lower)) %>%
mutate(upper=ifelse(var=="Financial\nLiteracy", upper*sd(data$FinancialLiteracy), upper)) %>%
# Income
mutate(beta=ifelse(var=="Income", beta*sd(data$numeric_income, na.rm=T), beta)) %>%
mutate(lower=ifelse(var=="Income", lower*sd(data$numeric_income, na.rm=T), lower)) %>%
mutate(upper=ifelse(var=="Income", upper*sd(data$numeric_income, na.rm=T), upper)) %>%
mutate(x = x+rep(c(0.2, 0.1, 0, -0.1, -0.2), 8)) %>%
mutate(study=factor(study, labels = c("MrAB", "Game", "Jacket", "Play", "Plane", "Drink", "Gym"),
levels = c("MrAB", "Game", "Jacket", "Play", "Plane", "Drink", "Gym"),
)) %>%
ggplot(aes(x, beta, fill=var, color=study, shape=is_sign, linetype=is_sign)) +
geom_hline(yintercept = 0, linewidth=0.2) +
geom_segment(aes(x = x, xend=x, y=lower, yend=upper)) +
geom_point(stat="identity", size=3) +
theme_cowplot() +
scale_x_continuous(breaks = c(1.5, 3:8),
labels = c("MrAB", "Game", "Jacket", "Play",
"Plane", "Drink", "Gym"),
guide = "prism_offset") +
scale_y_continuous(guide = "prism_offset") +
labs(fill=NULL, x=NULL, y=expression(Standardized~beta), color="Study") +
theme(legend.position = c(0.85, 0.25),
text = element_text(size = 15, family="Arial"),
# strip.background = element_rect(fill="#E2E2E2"),
strip.background = element_rect(fill="#F9F9F9"),
# axis.ticks.x = element_blank(),
axis.text.x = element_blank()) +
guides(fill="none", alpha="none", shape="none", linetype="none") +
facet_wrap(~var) +
scale_color_manual(values = colorspace::qualitative_hcl(7, "Dark 3")[c(5, 2, 4, 7, 6, 1, 3)])
ggsave("./index_files/figure-html/exploratory.svg", device = "svg", width = 8, height = 4.5)
library(rsvg)
library(stringi)
library(stringr)
imgs <- list.files("index_files/figure-html/")
for( img_i in imgs){
cat( which(img_i==imgs), "/", length(imgs), "\r" )
if( str_detect(img_i, ".svg") ){
rsvg_pdf(
str_c("index_files/figure-html/", img_i),
str_c("index_files/figure-html/", str_replace(img_i, ".svg", ".pdf"))
)
}
}
df %>%
mutate(is_sign=factor(is_sign, levels=c("yes", "no"))) %>%
mutate(study=ifelse( (study=="MrAB1" | study=="MrAB2"), "MrAB", study)) %>%
# Age
mutate(beta=ifelse(var=="Age", beta*sd(data$Age), beta)) %>%
mutate(lower=ifelse(var=="Age", lower*sd(data$Age), lower)) %>%
mutate(upper=ifelse(var=="Age", upper*sd(data$Age), upper)) %>%
# Education
mutate(beta=ifelse(var=="Education", beta*sd(data$Education), beta)) %>%
mutate(lower=ifelse(var=="Education", lower*sd(data$Education), lower)) %>%
mutate(upper=ifelse(var=="Education", upper*sd(data$Education), upper)) %>%
# Financial Literacy
mutate(beta=ifelse(var=="Financial\nLiteracy", beta*sd(data$FinancialLiteracy), beta)) %>%
mutate(lower=ifelse(var=="Financial\nLiteracy", lower*sd(data$FinancialLiteracy), lower)) %>%
mutate(upper=ifelse(var=="Financial\nLiteracy", upper*sd(data$FinancialLiteracy), upper)) %>%
# Income
mutate(beta=ifelse(var=="Income", beta*sd(data$numeric_income, na.rm=T), beta)) %>%
mutate(lower=ifelse(var=="Income", lower*sd(data$numeric_income, na.rm=T), lower)) %>%
mutate(upper=ifelse(var=="Income", upper*sd(data$numeric_income, na.rm=T), upper)) %>%
mutate(x = x+rep(c(0.2, 0.1, 0, -0.1, -0.2), 8)) %>%
mutate(study=factor(study, labels = c("MrAB", "Game", "Jacket", "Play", "Plane", "Drink", "Gym"),
levels = c("MrAB", "Game", "Jacket", "Play", "Plane", "Drink", "Gym"),
)) %>%
ggplot(aes(x, beta, fill=var, color=study, linetype=is_sign)) +
geom_hline(yintercept = 0, linewidth=0.2) +
geom_segment(aes(x = x, xend=x, y=lower, yend=upper)) +
geom_point(stat="identity", size=3) +
theme_cowplot() +
scale_x_continuous(breaks = c(1.5, 3:8),
labels = c("MrAB", "Game", "Jacket", "Play",
"Plane", "Drink", "Gym"),
guide = "prism_offset") +
scale_y_continuous(guide = "prism_offset") +
labs(fill=NULL, x=NULL, y=expression(Standardized~beta), color="Study") +
theme(legend.position = c(0.85, 0.25),
text = element_text(size = 15, family="Arial"),
# strip.background = element_rect(fill="#E2E2E2"),
strip.background = element_rect(fill="#F9F9F9"),
# axis.ticks.x = element_blank(),
axis.text.x = element_blank()) +
guides(fill="none", alpha="none", shape="none", linetype="none") +
facet_wrap(~var) +
scale_color_manual(values = colorspace::qualitative_hcl(7, "Dark 3")[c(5, 2, 4, 7, 6, 1, 3)])
ggsave("./index_files/figure-html/exploratory.svg", device = "svg", width = 8, height = 4.5)
library(rsvg)
library(stringi)
library(stringr)
imgs <- list.files("index_files/figure-html/")
for( img_i in imgs){
cat( which(img_i==imgs), "/", length(imgs), "\r" )
if( str_detect(img_i, ".svg") ){
rsvg_pdf(
str_c("index_files/figure-html/", img_i),
str_c("index_files/figure-html/", str_replace(img_i, ".svg", ".pdf"))
)
}
}
library(rsvg)
library(stringi)
library(stringr)
imgs <- list.files("index_files/figure-html/")
for( img_i in imgs){
cat( which(img_i==imgs), "/", length(imgs), "\r" )
if( str_detect(img_i, ".svg") ){
rsvg_pdf(
str_c("index_files/figure-html/", img_i),
str_c("index_files/figure-html/", str_replace(img_i, ".svg", ".pdf"))
)
}
}
